import numpy as np
import json

###################################################
# BitBoards for Crawlers (Pawns, Knights and King)
###################################################

# For crawlers we can easily compute possible moves using the bit encoded position and a 
# precomputed table of the positions in which it may move from each square. Here it is not 
# needed to use symmetries, since there is not too many bits to store. For sliders it is different.

########################################################################
# Magic BitBoards and Magic Numbers for Sliders (Rooks, Bishops, Queens)
########################################################################

# Magic BitBoards are a clever method that uses precomputed tables of where pieces may move from a certain square. 
# Precomputed tables contain for each piece a number which represents the moves it can make taking into account the
# blocking pieces, each of the pairs piece, square has a magic number which when multplying in some way gives a
# new number, this number is the index. Which corresponds to the index of the array of possible moves the piece
# can make taking into account the blocking pieces.
# 
# One doesn't need to store the configurations when there is a piece at the edge of the board, since this doesn't 
# block further the path, as there are no further squares along that path. This reduces greatly the amount of 
# configurations stored. 
# 
# To find more about magic numbers see: Coding Adventure: Making a Better Chess Bot minute 28.30-39.00.
#
# My own idea is to exploit the symmetries so that for each piece we only need to store 16 bitboards instead of 
# 64. This makes finding the magic number easier, maybe even there's a smart way of ordering the bits for each square
# without using magic numbers.


####################################
# Pre-computed crawler tables 
####################################



# Precomputed move tables
knight_moves = (132096, 329728, 659712, 1319424, 2638848, 5277696, 10489856, 4202496, 33816580, 84410376, 168886289, 337772578, 675545156, 1351090312, 2685403152, 1075839008, 8657044482, 21609056261, 43234889994, 86469779988, 172939559976, 345879119952, 687463207072, 275414786112, 2216203387392, 5531918402816, 11068131838464, 22136263676928, 44272527353856, 88545054707712, 175990581010432, 70506185244672, 567348067172352, 1416171111120896, 2833441750646784, 5666883501293568, 11333767002587136, 22667534005174272, 45053588738670592, 18049583422636032, 145241105196122112, 362539804446949376, 725361088165576704, 1450722176331153408, 2901444352662306816, 5802888705324613632, 11533718717099671552, 4620693356194824192, 288234782788157440, 576469569871282176, 1224997833292120064, 2449995666584240128, 4899991333168480256, 9799982666336960512, 1152939783987658752, 2305878468463689728, 1128098930098176, 2257297371824128, 4796069720358912, 9592139440717824, 19184278881435648, 38368557762871296, 4679521487814656, 9077567998918656)
king_moves = (770, 1797, 3594, 7188, 14376, 28752, 57504, 49216, 197123, 460039, 920078, 1840156, 3680312, 7360624, 14721248, 12599488, 50463488, 117769984, 235539968, 471079936, 942159872, 1884319744, 3768639488, 3225468928, 12918652928, 30149115904, 60298231808, 120596463616, 241192927232, 482385854464, 964771708928, 825720045568, 3307175149568, 7718173671424, 15436347342848, 30872694685696, 61745389371392, 123490778742784, 246981557485568, 211384331665408, 846636838289408, 1975852459884544, 3951704919769088, 7903409839538176, 15806819679076352, 31613639358152704, 63227278716305408, 54114388906344448, 216739030602088448, 505818229730443264, 1011636459460886528, 2023272918921773056, 4046545837843546112, 8093091675687092224, 16186183351374184448, 13853283560024178688, 144959613005987840, 362258295026614272, 724516590053228544, 1449033180106457088, 2898066360212914176, 5796132720425828352, 11592265440851656704, 4665729213955833856)
white_pawn_moves = (256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 16842752, 33685504, 67371008, 134742016, 269484032, 538968064, 1077936128, 2155872256, 16777216, 33554432, 67108864, 134217728, 268435456, 536870912, 1073741824, 2147483648, 4294967296, 8589934592, 17179869184, 34359738368, 68719476736, 137438953472, 274877906944, 549755813888, 1099511627776, 2199023255552, 4398046511104, 8796093022208, 17592186044416, 35184372088832, 70368744177664, 140737488355328, 281474976710656, 562949953421312, 1125899906842624, 2251799813685248, 4503599627370496, 9007199254740992, 18014398509481984, 36028797018963968, 72057594037927936, 144115188075855872, 288230376151711744, 576460752303423488, 1152921504606846976, 2305843009213693952, 4611686018427387904, 9223372036854775808, 0, 0, 0, 0, 0, 0, 0, 0)
white_pawn_attacks = (512, 1280, 2560, 5120, 10240, 20480, 40960, 16384, 131072, 327680, 655360, 1310720, 2621440, 5242880, 10485760, 4194304, 33554432, 83886080, 167772160, 335544320, 671088640, 1342177280, 2684354560, 1073741824, 8589934592, 21474836480, 42949672960, 85899345920, 171798691840, 343597383680, 687194767360, 274877906944, 2199023255552, 5497558138880, 10995116277760, 21990232555520, 43980465111040, 87960930222080, 175921860444160, 70368744177664, 562949953421312, 1407374883553280, 2814749767106560, 5629499534213120, 11258999068426240, 22517998136852480, 45035996273704960, 18014398509481984, 144115188075855872, 360287970189639680, 720575940379279360, 1441151880758558720, 2882303761517117440, 5764607523034234880, 11529215046068469760, 4611686018427387904, 0, 0, 0, 0, 0, 0, 0, 0)
black_pawn_moves = (0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152, 4194304, 8388608, 16777216, 33554432, 67108864, 134217728, 268435456, 536870912, 1073741824, 2147483648, 4294967296, 8589934592, 17179869184, 34359738368, 68719476736, 137438953472, 274877906944, 549755813888, 1103806595072, 2207613190144, 4415226380288, 8830452760576, 17660905521152, 35321811042304, 70643622084608, 141287244169216, 281474976710656, 562949953421312, 1125899906842624, 2251799813685248, 4503599627370496, 9007199254740992, 18014398509481984, 36028797018963968)
black_pawn_attacks = (0, 0, 0, 0, 0, 0, 0, 0, 2, 5, 10, 20, 40, 80, 160, 64, 512, 1280, 2560, 5120, 10240, 20480, 40960, 16384, 131072, 327680, 655360, 1310720, 2621440, 5242880, 10485760, 4194304, 33554432, 83886080, 167772160, 335544320, 671088640, 1342177280, 2684354560, 1073741824, 8589934592, 21474836480, 42949672960, 85899345920, 171798691840, 343597383680, 687194767360, 274877906944, 2199023255552, 5497558138880, 10995116277760, 21990232555520, 43980465111040, 87960930222080, 175921860444160, 70368744177664, 562949953421312, 1407374883553280, 2814749767106560, 5629499534213120, 11258999068426240, 22517998136852480, 45035996273704960, 18014398509481984)

board = [ 'R', 'N', 'B', 'Q', 'K', 'B', 'N', 'R',
         'P', 'P', 'P', 'P', 'P', 'P', 'P', 'P',
         '0', '0', '0', '0', '0', '0', '0', '0',
         '0', '0', '0', '0', '0', '0', '0', '0',
         '0', '0', '0', '0', '0', '0', '0', '0',
         '0', '0', '0', '0', '0', '0', '0', '0',
         'p', 'p', 'p', 'p', 'p', 'p', 'p', 'p',
         'r', 'n', 'b', 'q', 'k', 'b', 'n', 'k' ]


####################################
# Pre-computed slider tables 
####################################
# Number of squares in direction to move from all squares
rook_unfull_rays = (282578800148862, 565157600297596, 1130315200595066, 2260630401190006, 4521260802379886, 9042521604759646, 18085043209519166, 36170086419038334, 282578800180736, 565157600328704, 1130315200625152, 2260630401218048, 4521260802403840, 9042521604775424, 18085043209518592, 36170086419037696, 282578808340736, 565157608292864, 1130315208328192, 2260630408398848, 4521260808540160, 9042521608822784, 18085043209388032, 36170086418907136, 282580897300736, 565159647117824, 1130317180306432, 2260632246683648, 4521262379438080, 9042522644946944, 18085043175964672, 36170086385483776, 283115671060736, 565681586307584, 1130822006735872, 2261102847592448, 4521664529305600, 9042787892731904, 18085034619584512, 36170077829103616, 420017753620736, 699298018886144, 1260057572672512, 2381576680245248, 4624614895390720, 9110691325681664, 18082844186263552, 36167887395782656, 35466950888980736, 34905104758997504, 34344362452452352, 33222877839362048, 30979908613181440, 26493970160820224, 17522093256097792, 35607136465616896, 9079539427579068672, 8935706818303361536, 8792156787827803136, 8505056726876686336, 7930856604974452736, 6782456361169985536, 4485655873561051136, 9115426935197958144)
bishop_unfull_rays = (18049651735527936, 70506452091904, 275415828992, 1075975168, 38021120, 8657588224, 2216338399232, 567382630219776, 9024825867763712, 18049651735527424, 70506452221952, 275449643008, 9733406720, 2216342585344, 567382630203392, 1134765260406784, 4512412933816832, 9024825867633664, 18049651768822272, 70515108615168, 2491752130560, 567383701868544, 1134765256220672, 2269530512441344, 2256206450263040, 4512412900526080, 9024834391117824, 18051867805491712, 637888545440768, 1135039602493440, 2269529440784384, 4539058881568768, 1128098963916800, 2256197927833600, 4514594912477184, 9592139778506752, 19184279556981248, 2339762086609920, 4538784537380864, 9077569074761728, 562958610993152, 1125917221986304, 2814792987328512, 5629586008178688, 11259172008099840, 22518341868716544, 9007336962655232, 18014673925310464, 2216338399232, 4432676798464, 11064376819712, 22137335185408, 44272556441600, 87995357200384, 35253226045952, 70506452091904, 567382630219776, 1134765260406784, 2832480465846272, 5667157807464448, 11333774449049600, 22526811443298304, 9024825867763712, 18049651735527936)
queen_unfull_rays = (18332230535676798, 635664052389500, 1130590616424058, 2260631477165174, 4521260840401006, 9042530262347870, 18087259547918398, 36737469049258110, 9307404667944448, 18614809335856128, 1200821652847104, 2260905850861056, 4521270535810560, 9044737947360768, 18652425839721984, 37304851679444480, 4794991742157568, 9589983475926528, 19179966977150464, 2331145517014016, 4523752560670720, 9609905310691328, 19219808465608704, 38439616931348480, 2538787347563776, 5077572547643904, 10155151571424256, 20312500052175360, 5159150924878848, 10177562247440384, 20354572616749056, 40709145267052544, 1411214634977536, 2821879514141184, 5645416919213056, 11853242626099200, 23705944086286848, 11382549979341824, 22623819156965376, 45247646903865344, 982976364613888, 1825215240872448, 4074850560001024, 8011162688423936, 15883786903490560, 31629033194398208, 27090181148918784, 54182561321093120, 35469167227379968, 34909537435795968, 34355426829272064, 33245015174547456, 31024181169623040, 26581965518020608, 17557346482143744, 35677642917708800, 9080106810209288448, 8936841583563768320, 8794989268293649408, 8510723884684150784, 7942190379423502336, 6804983172613283840, 4494680699428814848, 9133476586933486080)
rook_full_rays = (72340172838076926, 144680345676153597, 289360691352306939, 578721382704613623, 1157442765409226991, 2314885530818453727, 4629771061636907199, 9259542123273814143, 72340172838141441, 144680345676217602, 289360691352369924, 578721382704674568, 1157442765409283856, 2314885530818502432, 4629771061636939584, 9259542123273813888, 72340172854657281, 144680345692602882, 289360691368494084, 578721382720276488, 1157442765423841296, 2314885530830970912, 4629771061645230144, 9259542123273748608, 72340177082712321, 144680349887234562, 289360695496279044, 578721386714368008, 1157442769150545936, 2314885534022901792, 4629771063767613504, 9259542123257036928, 72341259464802561, 144681423712944642, 289361752209228804, 578722409201797128, 1157443723186933776, 2314886351157207072, 4629771607097753664, 9259542118978846848, 72618349279904001, 144956323094725122, 289632270724367364, 578984165983651848, 1157687956502220816, 2315095537539358752, 4629910699613634624, 9259541023762186368, 143553341945872641, 215330564830528002, 358885010599838724, 645993902138460168, 1220211685215703056, 2368647251370188832, 4665518383679160384, 9259260648297103488, 18302911464433844481, 18231136449196065282, 18087586418720506884, 17800486357769390088, 17226286235867156496, 16077885992062689312, 13781085504453754944, 9187484529235886208)
bishop_full_rays = (9241421688590303744, 36099303471056128, 141012904249856, 550848566272, 6480472064, 1108177604608, 283691315142656, 72624976668147712, 4620710844295151618, 9241421688590368773, 36099303487963146, 141017232965652, 1659000848424, 283693466779728, 72624976676520096, 145249953336262720, 2310355422147510788, 4620710844311799048, 9241421692918565393, 36100411639206946, 424704217196612, 72625527495610504, 145249955479592976, 290499906664153120, 1155177711057110024, 2310355426409252880, 4620711952330133792, 9241705379636978241, 108724279602332802, 145390965166737412, 290500455356698632, 580999811184992272, 577588851267340304, 1155178802063085600, 2310639079102947392, 4693335752243822976, 9386671504487645697, 326598935265674242, 581140276476643332, 1161999073681608712, 288793334762704928, 577868148797087808, 1227793891648880768, 2455587783297826816, 4911175566595588352, 9822351133174399489, 1197958188344280066, 2323857683139004420, 144117404414255168, 360293502378066048, 720587009051099136, 1441174018118909952, 2882348036221108224, 5764696068147249408, 11529391036782871041, 4611756524879479810, 567382630219904, 1416240237150208, 2833579985862656, 5667164249915392, 11334324221640704, 22667548931719168, 45053622886727936, 18049651735527937)
queen_full_rays = (9313761861428380670, 180779649147209725, 289501704256556795, 578721933553179895, 1157442771889699055, 2314886638996058335, 4630054752952049855, 9332167099941961855, 4693051017133293059, 9386102034266586375, 325459994840333070, 578862399937640220, 1157444424410132280, 2315169224285282160, 4702396038313459680, 9404792076610076608, 2382695595002168069, 4765391190004401930, 9530782384287059477, 614821794359483434, 1157867469641037908, 2387511058326581416, 4775021017124823120, 9550042029937901728, 1227517888139822345, 2455035776296487442, 4910072647826412836, 9820426766351346249, 1266167048752878738, 2460276499189639204, 4920271519124312136, 9840541934442029200, 649930110732142865, 1299860225776030242, 2600000831312176196, 5272058161445620104, 10544115227674579473, 2641485286422881314, 5210911883574396996, 10421541192660455560, 361411684042608929, 722824471891812930, 1517426162373248132, 3034571949281478664, 6068863523097809168, 12137446670713758241, 5827868887957914690, 11583398706901190788, 287670746360127809, 575624067208594050, 1079472019650937860, 2087167920257370120, 4102559721436811280, 8133343319517438240, 16194909420462031425, 13871017173176583298, 18303478847064064385, 18232552689433215490, 18090419998706369540, 17806153522019305480, 17237620560088797200, 16100553540994408480, 13826139127340482880, 9205534180971414145)

bishop_pins = ((9241386435364257792, 9223407221226864640, 18049582881570816, 9223372105574252544, 18014467228958720, 35253091565568, 9223372036988993536, 18014398643699712, 35184506306560, 68853694464, 9223372036855037952, 18014398509744128, 35184372350976, 68719738880, 134479872, 9223372036854776320, 18014398509482496, 35184372089344, 68719477248, 134218240, 262656), (36099165763141632, 36028934457917440, 70506183131136, 36028797287399424, 70369012613120, 137707388928, 36028797019488256, 70368744701952, 137439477760, 268959744, 36028797018964992, 70368744178688, 137438954496, 268436480, 525312, 36028797018964224, 70368744177920, 137438953728, 268435712, 524544, 1280), (141012366262272, 140738025226240, 275414777856, 140737489403904, 274878955520, 537919488, 140737488420864, 274877972480, 536936448, 1114112, 140737488357376, 274877908992, 536872960, 1050624, 67584, 140737488355840, 274877907456, 536871424, 1049088, 66048, 2560), (550829555712, 549772591104, 1090519040, 549757911040, 1075838976, 18874368, 549755944960, 1073872896, 16908288, 2228224, 549755817984, 1073745920, 16781312, 2101248, 135168, 549755814912, 1073742848, 16778240, 2098176, 132096, 5120), (6442450944, 4328521728, 2181038080, 4299161600, 2151677952, 37748736, 4295229440, 2147745792, 33816576, 4456448, 4294975488, 2147491840, 33562624, 4202496, 270336, 4294969344, 2147485696, 33556480, 4196352, 264192, 10240), (1108101562368, 1099578736640, 8657043456, 1099520016384, 8598323200, 75497472, 1099512152064, 8590458880, 67633152, 8912896, 1099511644160, 8589950976, 67125248, 8404992, 540672, 1099511631872, 8589938688, 67112960, 8392704, 528384, 20480), (283673999966208, 281492156579840, 2216203124736, 281475110928384, 2199157473280, 17314086912, 281474977759232, 2199024304128, 17180917760, 135266304, 281474976743424, 2199023288320, 17179901952, 134250496, 1081344, 281474976718848, 2199023263744, 17179877376, 134225920, 1056768, 40960), (72620543991349248, 72061992084439040, 567347999932416, 72057628397666304, 562984313159680, 4432406249472, 72057594306363392, 562950221856768, 4398314946560, 34628173824, 72057594040025088, 562949955518464, 4398048608256, 34361835520, 270532608, 72057594037944320, 562949953437696, 4398046527488, 34359754752, 268451840, 2113536), (4620693217682128896, 4611703610613432320, 9024791440785408, 4611686052787126272, 9007233614479360, 17626545782784, 4611686018494496768, 9007199321849856, 17592253153280, 34426847232, 4611686018427518976, 9007199254872064, 17592186175488, 34359869440, 67239936, 4611686018427387906, 9007199254740994, 17592186044418, 34359738370, 67108866, 131074), (9241386435364257792, 9223407221226864640, 18049582881570816, 9223372105574252544, 18014467228958720, 35253091565568, 9223372036988993536, 18014398643699712, 35184506306560, 68853694464, 9223372036855037952, 18014398509744128, 35184372350976, 68719738880, 134479872, 9223372036854841344, 18014398509547520, 35184372154368, 68719542272, 134283264, 327680, 9223372036854775812, 18014398509481988, 35184372088836, 68719476740, 134217732, 262148, 65540, 9223372036854775809, 18014398509481985, 35184372088833, 68719476737, 134217729, 262145, 65537, 5), (36099165763141632, 36028934457917440, 70506183131136, 36028797287399424, 70369012613120, 137707388928, 36028797035741184, 70368760954880, 137455730688, 285212672, 36028797019488256, 70368744701952, 137439477760, 268959744, 17301504, 36028797019095040, 70368744308736, 137439084544, 268566528, 16908288, 655360, 36028797018963976, 70368744177672, 137438953480, 268435464, 16777224, 524296, 131080, 36028797018963970, 70368744177666, 137438953474, 268435458, 16777218, 524290, 131074, 10), (141012366262272, 140741783322624, 279172874240, 140738025226240, 275414777856, 4831838208, 140737521909760, 274911461376, 4328521728, 570425344, 140737489403904, 274878955520, 4296015872, 537919488, 34603008, 140737488617472, 274878169088, 4295229440, 537133056, 33816576, 1310720, 140737488355344, 274877906960, 4294967312, 536870928, 33554448, 1048592, 262160, 140737488355332, 274877906948, 4294967300, 536870916, 33554436, 1048580, 262148, 20), (1649267441664, 1108101562368, 558345748480, 1100585369600, 550829555712, 9663676416, 1099578736640, 549822922752, 8657043456, 1140850688, 1099513724928, 549757911040, 8592031744, 1075838976, 69206016, 1099512152064, 549756338176, 8590458880, 1074266112, 67633152, 2621440, 1099511627808, 549755813920, 8589934624, 1073741856, 67108896, 2097184, 524320, 1099511627784, 549755813896, 8589934600, 1073741832, 67108872, 2097160, 524296, 40), (283673999966208, 281492156579840, 2216203124736, 281477124194304, 2201170739200, 19327352832, 281475110928384, 2199157473280, 17314086912, 2281701376, 281474980904960, 2199027449856, 17184063488, 2151677952, 138412032, 281474977759232, 2199024304128, 17180917760, 2148532224, 135266304, 5242880, 281474976710720, 2199023255616, 17179869248, 2147483712, 134217792, 4194368, 1048640, 281474976710672, 2199023255568, 17179869200, 2147483664, 134217744, 4194320, 1048592, 80), (72620543991349248, 72061992084439040, 567347999932416, 72057628397666304, 562984313159680, 4432406249472, 72057594306363392, 562950221856768, 4398314946560, 34628173824, 72057594046316544, 562949961809920, 4398054899712, 34368126976, 276824064, 72057594040025088, 562949955518464, 4398048608256, 34361835520, 270532608, 10485760, 72057594037928064, 562949953421440, 4398046511232, 34359738496, 268435584, 8388736, 2097280, 72057594037927968, 562949953421344, 4398046511136, 34359738400, 268435488, 8388640, 2097184, 160), (145241087982698496, 144123984168878080, 1134695999864832, 144115256795332608, 1125968626319360, 8864812498944, 144115188612726784, 1125900443713536, 8796629893120, 69256347648, 144115188080050176, 1125899911036928, 8796097216512, 68723671040, 541065216, 144115188075855936, 1125899906842688, 8796093022272, 68719476800, 536870976, 4194368), (2310346608841064448, 2305851805306716160, 4512395720392704, 2305843026393563136, 4503616807239680, 8813272891392, 2305843009247248384, 4503599660924928, 8796126576640, 17213423616, 2305843009213694464, 4503599627371008, 8796093022720, 17179869696, 33554944, 2305843009213693956, 4503599627370500, 8796093022212, 17179869188, 33554436, 516), (4620693217682128896, 4611703610613432320, 9024791440785408, 4611686052787126272, 9007233614479360, 17626545782784, 4611686018494496768, 9007199321849856, 17592253153280, 34426847232, 4611686018444165120, 9007199271518208, 17592202821632, 34376515584, 83886080, 4611686018427388928, 9007199254742016, 17592186045440, 34359739392, 67109888, 16778240, 4611686018427388160, 9007199254741248, 17592186044672, 34359738624, 67109120, 16777472, 1280, 4611686018427387912, 9007199254741000, 17592186044424, 34359738376, 67108872, 16777224, 1032, 264), (9241386435364257792, 9223407221226864640, 18049582881570816, 9223372105574252544, 18014467228958720, 35253091565568, 9223372041149743104, 18014402804449280, 35188667056128, 73014444032, 9223372036988993536, 18014398643699712, 35184506306560, 68853694464, 4429185024, 9223372036888330240, 18014398543036416, 35184405643264, 68753031168, 4328521728, 167772160, 9223372036854777856, 18014398509484032, 35184372090880, 68719478784, 4294969344, 134219776, 33556480, 9223372036854776320, 18014398509482496, 35184372089344, 68719477248, 4294967808, 134218240, 33554944, 2560, 9223372036854775824, 18014398509482000, 35184372088848, 68719476752, 4294967312, 134217744, 33554448, 2064, 528, 9223372036854775809, 18014398509481985, 35184372088833, 68719476737, 4294967297, 134217729, 33554433, 2049, 513, 17), (36099165763141632, 36029896530591744, 71468255805440, 36028934457917440, 70506183131136, 1236950581248, 36028805608898560, 70377334112256, 1108101562368, 146028888064, 36028797287399424, 70369012613120, 1099780063232, 137707388928, 8858370048, 36028797086072832, 70368811286528, 1099578736640, 137506062336, 8657043456, 335544320, 36028797018968064, 70368744181760, 1099511631872, 137438957568, 8589938688, 268439552, 67112960, 36028797018964992, 70368744178688, 1099511628800, 137438954496, 8589935616, 268436480, 67109888, 5120, 36028797018964000, 70368744177696, 1099511627808, 137438953504, 8589934624, 268435488, 67108896, 4128, 1056, 36028797018963970, 70368744177666, 1099511627778, 137438953474, 8589934594, 268435458, 67108866, 4098, 1026, 34), (422212465065984, 283673999966208, 142936511610880, 281749854617600, 141012366262272, 2473901162496, 281492156579840, 140754668224512, 2216203124736, 292057776128, 281475513581568, 140738025226240, 2199560126464, 275414777856, 17716740096, 281475110928384, 140737622573056, 2199157473280, 275012124672, 17314086912, 671088640, 281474976718848, 140737488363520, 2199023263744, 274877915136, 17179877376, 536879104, 134225920, 281474976712704, 140737488357376, 2199023257600, 274877908992, 17179871232, 536872960, 134219776, 10240, 281474976710720, 140737488355392, 2199023255616, 274877907008, 17179869248, 536870976, 134217792, 8256, 2112, 281474976710660, 140737488355332, 2199023255556, 274877906948, 17179869188, 536870916, 134217732, 8196, 2052, 68), (72620543991349248, 72061992084439040, 567347999932416, 72058143793741824, 563499709235200, 4947802324992, 72057628397666304, 562984313159680, 4432406249472, 584115552256, 72057595111669760, 562951027163136, 4399120252928, 550829555712, 35433480192, 72057594306363392, 562950221856768, 4398314946560, 550024249344, 34628173824, 1342177280, 72057594037944320, 562949953437696, 4398046527488, 549755830272, 34359754752, 1073758208, 268451840, 72057594037932032, 562949953425408, 4398046515200, 549755817984, 34359742464, 1073745920, 268439552, 20480, 72057594037928064, 562949953421440, 4398046511232, 549755814016, 34359738496, 1073741952, 268435584, 16512, 4224, 72057594037927944, 562949953421320, 4398046511112, 549755813896, 34359738376, 1073741832, 268435464, 16392, 4104, 136), (145241087982698496, 144123984168878080, 1134695999864832, 144115256795332608, 1125968626319360, 8864812498944, 144115190223339520, 1125902054326272, 8798240505856, 70866960384, 144115188612726784, 1125900443713536, 8796629893120, 69256347648, 2684354560, 144115188075888640, 1125899906875392, 8796093054976, 68719509504, 2147516416, 536903680, 144115188075864064, 1125899906850816, 8796093030400, 68719484928, 2147491840, 536879104, 40960, 144115188075855888, 1125899906842640, 8796093022224, 68719476752, 2147483664, 536870928, 32784, 8208), (290482175965396992, 288247968337756160, 2269391999729664, 288230513590665216, 2251937252638720, 17729624997888, 288230377225453568, 2251800887427072, 17593259786240, 138512695296, 288230376151728128, 2251799813701632, 17592186060800, 137438969856, 1073758208, 288230376151711776, 2251799813685280, 17592186044448, 137438953504, 1073741856, 16416), (1155173304420532224, 1152925902653358080, 2256197860196352, 1152921513196781568, 2251808403619840, 4406636445696, 1152921504606978048, 2251799813816320, 4398046642176, 8590065664, 1152921504606848000, 2251799813686272, 4398046512128, 8589935616, 132096, 1152921504606846984, 2251799813685256, 4398046511112, 8589934600, 131080, 1032), (2310346608841064448, 2305851805306716160, 4512395720392704, 2305843026393563136, 4503616807239680, 8813272891392, 2305843013508661248, 4503603922337792, 8800387989504, 21474836480, 2305843009213956096, 4503599627632640, 8796093284352, 17180131328, 4295229440, 2305843009213759488, 4503599627436032, 8796093087744, 17179934720, 4295032832, 327680, 2305843009213696000, 4503599627372544, 8796093024256, 17179871232, 4294969344, 264192, 67584, 2305843009213693968, 4503599627370512, 8796093022224, 17179869200, 4294967312, 262160, 65552, 2064), (4620693217682128896, 4611703610613432320, 9024791440785408, 4611687117939015680, 9008298766368768, 18691697672192, 4611686052787126272, 9007233614479360, 17626545782784, 1133871366144, 4611686027017322496, 9007207844675584, 17600775979008, 1108101562368, 42949672960, 4611686018427912192, 9007199255265280, 17592186568704, 1099512152064, 34360262656, 8590458880, 4611686018427518976, 9007199254872064, 17592186175488, 1099511758848, 34359869440, 8590065664, 655360, 4611686018427392000, 9007199254745088, 17592186048512, 1099511631872, 34359742464, 8589938688, 528384, 135168, 4611686018427388160, 9007199254741248, 17592186044672, 1099511628032, 34359738624, 8589934848, 524544, 131328, 4352, 4611686018427387936, 9007199254741024, 17592186044448, 1099511627808, 34359738400, 8589934624, 524320, 131104, 4128, 288), (9241386435364257792, 9223653511831486464, 18295873486192640, 9223407221226864640, 18049582881570816, 316659348799488, 9223374235878031360, 18016597532737536, 283673999966208, 37383395344384, 9223372105574252544, 18014467228958720, 281543696187392, 35253091565568, 2267742732288, 9223372054034644992, 18014415689351168, 281492156579840, 35201551958016, 2216203124736, 85899345920, 9223372036855824384, 18014398510530560, 281474977759232, 35184373137408, 2199024304128, 68720525312, 17180917760, 9223372036855037952, 18014398509744128, 281474976972800, 35184372350976, 2199023517696, 68719738880, 17180131328, 1310720, 9223372036854784000, 18014398509490176, 281474976718848, 35184372097024, 2199023263744, 68719484928, 17179877376, 1056768, 270336, 9223372036854776320, 18014398509482496, 281474976711168, 35184372089344, 2199023256064, 68719477248, 17179869696, 1049088, 262656, 8704, 9223372036854775872, 18014398509482048, 281474976710720, 35184372088896, 2199023255616, 68719476800, 17179869248, 1048640, 262208, 8256, 576, 9223372036854775809, 18014398509481985, 281474976710657, 35184372088833, 2199023255553, 68719476737, 17179869185, 1048577, 262145, 8193, 513, 65), (108086391056891904, 72620543991349248, 36591746972385280, 72127962782105600, 36099165763141632, 633318697598976, 72061992084439040, 36033195065475072, 567347999932416, 74766790688768, 72057731476881408, 36028934457917440, 563087392374784, 70506183131136, 4535485464576, 72057628397666304, 36028831378702336, 562984313159680, 70403103916032, 4432406249472, 171798691840, 72057594040025088, 36028797021061120, 562949955518464, 70368746274816, 4398048608256, 137441050624, 34361835520, 72057594038452224, 36028797019488256, 562949953945600, 70368744701952, 4398047035392, 137439477760, 34360262656, 2621440, 72057594037944320, 36028797018980352, 562949953437696, 70368744194048, 4398046527488, 137438969856, 34359754752, 2113536, 540672, 72057594037928960, 36028797018964992, 562949953422336, 70368744178688, 4398046512128, 137438954496, 34359739392, 2098176, 525312, 17408, 72057594037928064, 36028797018964096, 562949953421440, 70368744177792, 4398046511232, 137438953600, 34359738496, 2097280, 524416, 16512, 1152, 72057594037927938, 36028797018963970, 562949953421314, 70368744177666, 4398046511106, 137438953474, 34359738370, 2097154, 524290, 16386, 1026, 130), (145241087982698496, 144255925564211200, 1266637395197952, 144123984168878080, 1134695999864832, 149533581377536, 144115462953762816, 1126174784749568, 141012366262272, 9070970929152, 144115256795332608, 1125968626319360, 140806207832064, 8864812498944, 343597383680, 144115188080050176, 1125899911036928, 140737492549632, 8796097216512, 274882101248, 68723671040, 144115188076904448, 1125899907891200, 140737489403904, 8796094070784, 274878955520, 68720525312, 5242880, 144115188075888640, 1125899906875392, 140737488388096, 8796093054976, 274877939712, 68719509504, 4227072, 1081344, 144115188075857920, 1125899906844672, 140737488357376, 8796093024256, 274877908992, 68719478784, 4196352, 1050624, 34816, 144115188075855876, 1125899906842628, 140737488355332, 8796093022212, 274877906948, 68719476740, 4194308, 1048580, 32772, 2052), (290482175965396992, 288247968337756160, 2269391999729664, 288230925907525632, 2252349569499136, 18141941858304, 288230513590665216, 2251937252638720, 17729624997888, 687194767360, 288230376160100352, 2251799822073856, 17592194433024, 549764202496, 137447342080, 288230376153808896, 2251799815782400, 17592188141568, 549757911040, 137441050624, 10485760, 288230376151715840, 2251799813689344, 17592186048512, 549755817984, 137438957568, 8392704, 2101248, 288230376151711752, 2251799813685256, 17592186044424, 549755813896, 137438953480, 8388616, 2097160, 4104), (580964351930793984, 576495936675512320, 4538783999459328, 576461027181330432, 4503874505277440, 35459249995776, 576460752307617792, 4503599631564800, 35184376283136, 274882101248, 576460752303431680, 4503599627378688, 35184372097024, 274877915136, 4202496, 576460752303423504, 4503599627370512, 35184372088848, 274877906960, 4194320, 8208), (577586652210266112, 576462951326679040, 1128098930098176, 576460752336977920, 1125899940397056, 2199056809984, 576460752303685632, 1125899907104768, 2199023517696, 33816576, 576460752303425536, 1125899906844672, 2199023257600, 33556480, 264192, 576460752303423504, 1125899906842640, 2199023255568, 33554448, 262160, 2064), (1155173304420532224, 1152925902653358080, 2256197860196352, 1152922604118474752, 2252899325313024, 5497558138880, 1152921504673955840, 2251799880794112, 4398113619968, 1099578736640, 1152921504623624192, 2251799830462464, 4398063288320, 1099528404992, 83886080, 1152921504607371264, 2251799814209536, 4398047035392, 1099512152064, 67633152, 17301504, 1152921504606851072, 2251799813689344, 4398046515200, 1099511631872, 67112960, 16781312, 528384, 1152921504606847008, 2251799813685280, 4398046511136, 1099511627808, 67108896, 16777248, 524320, 4128), (2310346608841064448, 2306124484190404608, 4785074604081152, 2305851805306716160, 4512395720392704, 290271069732864, 2305845208236949504, 4505798650626048, 283673999966208, 10995116277760, 2305843009347911680, 4503599761588224, 281475110928384, 8796227239936, 2199157473280, 2305843009247248384, 4503599660924928, 281475010265088, 8796126576640, 2199056809984, 167772160, 2305843009214742528, 4503599628419072, 281474977759232, 8796094070784, 2199024304128, 135266304, 34603008, 2305843009213759488, 4503599627436032, 281474976776192, 8796093087744, 2199023321088, 134283264, 33619968, 1114112, 2305843009213702144, 4503599627378688, 281474976718848, 8796093030400, 2199023263744, 134225920, 33562624, 1056768, 73728, 2305843009213694016, 4503599627370560, 281474976710720, 8796093022272, 2199023255616, 134217792, 33554496, 1048640, 65600, 8256), (4683743612465315840, 4620693217682128896, 81064793292668928, 4612248968380809216, 72620543991349248, 9570149208162304, 4611703610613432320, 72075186223972352, 9024791440785408, 580542139465728, 4611690416473899008, 72061992084439040, 9011597301252096, 567347999932416, 21990232555520, 4611686018695823360, 72057594306363392, 9007199523176448, 562950221856768, 17592454479872, 4398314946560, 4611686018494496768, 72057594105036800, 9007199321849856, 562950020530176, 17592253153280, 4398113619968, 335544320, 4611686018429485056, 72057594040025088, 9007199256838144, 562949955518464, 17592188141568, 4398048608256, 270532608, 69206016, 4611686018427518976, 72057594038059008, 9007199254872064, 562949953552384, 17592186175488, 4398046642176, 268566528, 67239936, 2228224, 4611686018427404288, 72057594037944320, 9007199254757376, 562949953437696, 17592186060800, 4398046527488, 268451840, 67125248, 2113536, 147456, 4611686018427388160, 72057594037928192, 9007199254741248, 562949953421568, 17592186044672, 4398046511360, 268435712, 67109120, 2097408, 131328, 16640, 4611686018427388032, 72057594037928064, 9007199254741120, 562949953421440, 17592186044544, 4398046511232, 268435584, 67108992, 2097280, 131200, 16512, 384), (9367487224930631680, 9241386435364257792, 162129586585337856, 9224497936761618432, 145241087982698496, 19140298416324608, 9223407221226864640, 144150372447944704, 18049582881570816, 1161084278931456, 9223380832947798016, 144123984168878080, 18023194602504192, 1134695999864832, 43980465111040, 9223372037391646720, 144115188612726784, 18014399046352896, 1125900443713536, 35184908959744, 8796629893120, 9223372036988993536, 144115188210073600, 18014398643699712, 1125900041060352, 35184506306560, 8796227239936, 671088640, 9223372036858970112, 144115188080050176, 18014398513676288, 1125899911036928, 35184376283136, 8796097216512, 541065216, 138412032, 9223372036855037952, 144115188076118016, 18014398509744128, 1125899907104768, 35184372350976, 8796093284352, 537133056, 134479872, 4456448, 9223372036854808576, 144115188075888640, 18014398509514752, 1125899906875392, 35184372121600, 8796093054976, 536903680, 134250496, 4227072, 294912, 9223372036854776320, 144115188075856384, 18014398509482496, 1125899906843136, 35184372089344, 8796093022720, 536871424, 134218240, 4194816, 262656, 33280, 9223372036854775809, 144115188075855873, 18014398509481985, 1125899906842625, 35184372088833, 8796093022209, 536870913, 134217729, 4194305, 262145, 32769, 513), (324259173170675712, 290482175965396992, 38280596832649216, 288300744895889408, 36099165763141632, 2322168557862912, 288247968337756160, 36046389205008384, 2269391999729664, 87960930222080, 288230377225453568, 36028798092705792, 2251800887427072, 70369817919488, 17593259786240, 288230376420147200, 36028797287399424, 2251800082120704, 70369012613120, 17592454479872, 1342177280, 288230376160100352, 36028797027352576, 2251799822073856, 70368752566272, 17592194433024, 1082130432, 276824064, 288230376152236032, 36028797019488256, 2251799814209536, 70368744701952, 17592186568704, 1074266112, 268959744, 8912896, 288230376151712768, 36028797018964992, 2251799813686272, 70368744178688, 17592186045440, 1073742848, 268436480, 8389632, 525312, 288230376151711746, 36028797018963970, 2251799813685250, 70368744177666, 17592186044418, 1073741826, 268435458, 8388610, 524290, 1026), (580964351930793984, 576601489791778816, 4644337115725824, 576495936675512320, 4538783999459328, 175921860444160, 576460754450907136, 4503601774854144, 140739635838976, 35186519572480, 576460752840294400, 4503600164241408, 140738025226240, 35184908959744, 2684354560, 576460752304472064, 4503599628419072, 140737489403904, 35184373137408, 2148532224, 537919488, 576460752303425536, 4503599627372544, 140737488357376, 35184372090880, 2147485696, 536872960, 1050624, 576460752303423492, 4503599627370500, 140737488355332, 35184372088836, 2147483652, 536870916, 1048580, 2052), (1161928703861587968, 1152991873351024640, 9077567998918656, 1152921505680588800, 9007200328482816, 70369817919488, 1152921504608944128, 9007199256838144, 70368746274816, 1075838976, 1152921504606851072, 9007199254745088, 70368744181760, 1073745920, 2101248, 1152921504606846984, 9007199254741000, 70368744177672, 1073741832, 2097160, 4104), (288793326105133056, 288230384741646336, 562958543355904, 288230376218820608, 562950020530176, 8657043456, 288230376152236032, 562949953945600, 8590458880, 67633152, 288230376151715840, 562949953425408, 8589938688, 67112960, 528384, 288230376151711776, 562949953421344, 8589934624, 67108896, 524320, 4128), (577586652210266112, 576742227280134144, 1407374883553280, 576460769483292672, 1125917086711808, 281492156579840, 576460756598390784, 1125904201809920, 281479271677952, 21474836480, 576460752437641216, 1125900041060352, 281475110928384, 17314086912, 4429185024, 576460752304472064, 1125899907891200, 281474977759232, 17180917760, 4296015872, 135266304, 576460752303431680, 1125899906850816, 281474976718848, 17179877376, 4294975488, 134225920, 1056768, 576460752303423552, 1125899906842688, 281474976710720, 17179869248, 4294967360, 134217792, 1048640, 8256), (1224979098644774912, 1155173304420532224, 74309393851613184, 1153484454560268288, 72620543991349248, 2814749767106560, 1152921538966585344, 72057628397666304, 2251834173423616, 562984313159680, 1152921513196781568, 72057602627862528, 2251808403619840, 562958543355904, 42949672960, 1152921504875282432, 72057594306363392, 2251800082120704, 562950221856768, 34628173824, 8858370048, 1152921504623624192, 72057594054705152, 2251799830462464, 562949970198528, 34376515584, 8606711808, 285212672, 1152921504608944128, 72057594040025088, 2251799815782400, 562949955518464, 34361835520, 8592031744, 270532608, 18874368, 1152921504606863360, 72057594037944320, 2251799813701632, 562949953437696, 34359754752, 8589950976, 268451840, 16793600, 2113536, 1152921504606847104, 72057594037928064, 2251799813685376, 562949953421440, 34359738496, 8589934720, 268435584, 16777344, 2097280, 16512), (2449958197289549824, 2310346608841064448, 148618787703226368, 2306968909120536576, 145241087982698496, 5629499534213120, 2305843077933170688, 144115256795332608, 4503668346847232, 1125968626319360, 2305843026393563136, 144115205255725056, 4503616807239680, 1125917086711808, 85899345920, 2305843009750564864, 144115188612726784, 4503600164241408, 1125900443713536, 69256347648, 17716740096, 2305843009247248384, 144115188109410304, 4503599660924928, 1125899940397056, 68753031168, 17213423616, 570425344, 2305843009217888256, 144115188080050176, 4503599631564800, 1125899911036928, 68723671040, 17184063488, 541065216, 37748736, 2305843009213759488, 144115188075921408, 4503599627436032, 1125899906908160, 68719542272, 17179934720, 536936448, 33619968, 4259840, 2305843009213726720, 144115188075888640, 4503599627403264, 1125899906875392, 68719509504, 17179901952, 536903680, 33587200, 4227072, 98304), (4899916394579099648, 4620693217682128896, 297237575406452736, 4613937818241073152, 290482175965396992, 11258999068426240, 4611686155866341376, 288230513590665216, 9007336693694464, 2251937252638720, 4611686052787126272, 288230410511450112, 9007233614479360, 2251834173423616, 171798691840, 4611686019501129728, 288230377225453568, 9007200328482816, 2251800887427072, 138512695296, 35433480192, 4611686018494496768, 288230376218820608, 9007199321849856, 2251799880794112, 137506062336, 34426847232, 1140850688, 4611686018435776512, 288230376160100352, 9007199263129600, 2251799822073856, 137447342080, 34368126976, 1082130432, 75497472, 4611686018427518976, 288230376151842816, 9007199254872064, 2251799813816320, 137439084544, 34359869440, 1073872896, 67239936, 8519680, 4611686018427388160, 288230376151712000, 9007199254741248, 2251799813685504, 137438953728, 34359738624, 1073742080, 67109120, 8388864, 131328), (9799832789158199296, 9241386435364257792, 594475150812905472, 9227875636482146304, 580964351930793984, 22517998136852480, 9223372311732682752, 576461027181330432, 18014673387388928, 4503874505277440, 9223372105574252544, 576460821022900224, 18014467228958720, 4503668346847232, 343597383680, 9223372039002259456, 576460754450907136, 18014400656965632, 4503601774854144, 277025390592, 70866960384, 9223372036988993536, 576460752437641216, 18014398643699712, 4503599761588224, 275012124672, 68853694464, 2281701376, 9223372036855037952, 576460752303685632, 18014398509744128, 4503599627632640, 274878169088, 68719738880, 2147745792, 134479872, 9223372036854776320, 576460752303424000, 18014398509482496, 4503599627371008, 274877907456, 68719477248, 2147484160, 134218240, 262656, 9223372036854775809, 576460752303423489, 18014398509481985, 4503599627370497, 274877906945, 68719476737, 2147483649, 134217729, 262145, 513), (1188950301625810944, 1161928703861587968, 45035996273704960, 1152922054362660864, 36029346774777856, 9007749010554880, 1152921642045800448, 36028934457917440, 9007336693694464, 687194767360, 1152921504875282432, 36028797287399424, 9007199523176448, 550024249344, 137707388928, 1152921504607371264, 36028797019488256, 9007199255265280, 549756338176, 137439477760, 268959744, 1152921504606848000, 36028797018964992, 9007199254742016, 549755814912, 137438954496, 268436480, 525312, 1152921504606846978, 36028797018963970, 9007199254740994, 549755813890, 137438953474, 268435458, 524290, 1026), (2323857407723175936, 2305843284091600896, 18014673387388928, 2305843009750564864, 18014399046352896, 275414777856, 2305843009214742528, 18014398510530560, 274878955520, 537919488, 2305843009213696000, 18014398509484032, 274877908992, 536872960, 1050624, 2305843009213693956, 18014398509481988, 274877906948, 536870916, 1048580, 2052), (144117387099111424, 144115205255725056, 2216203124736, 144115188210073600, 2199157473280, 17314086912, 144115188076904448, 2199024304128, 17180917760, 135266304, 144115188075864064, 2199023263744, 17179877376, 134225920, 1056768, 144115188075855936, 2199023255616, 17179869248, 134217792, 1048640, 8256), (360287970189639680, 288234774198222848, 72061992084439040, 288231475663339520, 72058693549555712, 5497558138880, 288230410511450112, 72057628397666304, 4432406249472, 1133871366144, 288230376420147200, 72057594306363392, 4398314946560, 1099780063232, 34628173824, 288230376153808896, 72057594040025088, 4398048608256, 1099513724928, 34361835520, 270532608, 288230376151728128, 72057594037944320, 4398046527488, 1099511644160, 34359754752, 268451840, 2113536, 288230376151711872, 72057594037928064, 4398046511232, 1099511627904, 34359738496, 268435584, 2097280, 16512), (720575940379279360, 576469548396445696, 144123984168878080, 576462951326679040, 144117387099111424, 10995116277760, 576460821022900224, 144115256795332608, 8864812498944, 2267742732288, 576460756598390784, 144115192370823168, 8800387989504, 2203318222848, 73014444032, 576460752840294400, 144115188612726784, 8796629893120, 2199560126464, 69256347648, 4831838208, 576460752307617792, 144115188080050176, 8796097216512, 2199027449856, 68723671040, 4299161600, 541065216, 576460752303456256, 144115188075888640, 8796093054976, 2199023288320, 68719509504, 4295000064, 536903680, 4227072), (1441151880758558720, 1152939096792891392, 288247968337756160, 1152925902653358080, 288234774198222848, 21990232555520, 1152921642045800448, 288230513590665216, 17729624997888, 4535485464576, 1152921513196781568, 288230384741646336, 17600775979008, 4406636445696, 146028888064, 1152921505680588800, 288230377225453568, 17593259786240, 4399120252928, 138512695296, 9663676416, 1152921504623624192, 288230376168488960, 17592202821632, 4398063288320, 137455730688, 8606711808, 1090519040, 1152921504615235584, 288230376160100352, 17592194433024, 4398054899712, 137447342080, 8598323200, 1082130432, 25165824), (2882303761517117440, 2305878193585782784, 576495936675512320, 2305851805306716160, 576469548396445696, 43980465111040, 2305843284091600896, 576461027181330432, 35459249995776, 9070970929152, 2305843026393563136, 576460769483292672, 35201551958016, 8813272891392, 292057776128, 2305843011361177600, 576460754450907136, 35186519572480, 8798240505856, 277025390592, 19327352832, 2305843009247248384, 576460752336977920, 35184405643264, 8796126576640, 274911461376, 17213423616, 2181038080, 2305843009213759488, 576460752303489024, 35184372154368, 8796093087744, 274877972480, 17179934720, 2147549184, 33619968), (5764607523034234880, 4611756387171565568, 1152991873351024640, 4611703610613432320, 1152939096792891392, 87960930222080, 4611686568183201792, 1152922054362660864, 70918499991552, 18141941858304, 4611686052787126272, 1152921538966585344, 70403103916032, 17626545782784, 584115552256, 4611686018494496768, 1152921504673955840, 70368811286528, 17592253153280, 549822922752, 34426847232, 4611686018427518976, 1152921504606978048, 70368744308736, 17592186175488, 549755944960, 34359869440, 67239936, 4611686018427388160, 1152921504606847232, 70368744177920, 17592186044672, 549755814144, 34359738624, 67109120, 131328), (11529215046068469760, 9223512774343131136, 2305983746702049280, 9223407221226864640, 2305878193585782784, 175921860444160, 9223372105574252544, 2305843077933170688, 140806207832064, 35253091565568, 9223372036988993536, 2305843009347911680, 140737622573056, 35184506306560, 68853694464, 9223372036855037952, 2305843009213956096, 140737488617472, 35184372350976, 68719738880, 134479872, 9223372036854776320, 2305843009213694464, 140737488355840, 35184372089344, 68719477248, 134218240, 262656, 9223372036854775809, 2305843009213693953, 140737488355329, 35184372088833, 68719476737, 134217729, 262145, 513), (4611756387171565568, 4611686155866341376, 70506183131136, 4611686018695823360, 70369012613120, 137707388928, 4611686018427912192, 70368744701952, 137439477760, 268959744, 4611686018427388928, 70368744178688, 137438954496, 268436480, 525312, 4611686018427387906, 70368744177666, 137438953474, 268435458, 524290, 1026), (567347999932416, 562984313159680, 4432406249472, 562950221856768, 4398314946560, 34628173824, 562949955518464, 4398048608256, 34361835520, 270532608, 562949953437696, 4398046527488, 34359754752, 268451840, 2113536, 562949953421440, 4398046511232, 34359738496, 268435584, 2097280, 16512), (1407374883553280, 1134695999864832, 290271069732864, 1125968626319360, 281543696187392, 8864812498944, 1125900443713536, 281475513581568, 8796629893120, 69256347648, 1125899911036928, 281474980904960, 8796097216512, 68723671040, 541065216, 1125899906875392, 281474976743424, 8796093054976, 68719509504, 536903680, 4227072), (2814749767106560, 2269391999729664, 580542139465728, 2252899325313024, 564049465049088, 18691697672192, 2251937252638720, 563087392374784, 17729624997888, 1236950581248, 2251800887427072, 562951027163136, 17593259786240, 1100585369600, 138512695296, 2251799822073856, 562949961809920, 17592194433024, 1099520016384, 137447342080, 1082130432), (5629499534213120, 4538783999459328, 1161084278931456, 4505798650626048, 1128098930098176, 37383395344384, 4503874505277440, 1126174784749568, 35459249995776, 2473901162496, 4503603922337792, 1125904201809920, 35188667056128, 2203318222848, 279172874240, 4503601774854144, 1125902054326272, 35186519572480, 2201170739200, 277025390592, 6442450944), (11258999068426240, 9077567998918656, 2322168557862912, 9011597301252096, 2256197860196352, 74766790688768, 9007749010554880, 2252349569499136, 70918499991552, 4947802324992, 9007207844675584, 2251808403619840, 70377334112256, 4406636445696, 558345748480, 9007199271518208, 2251799830462464, 70368760954880, 4398063288320, 549772591104, 8606711808), (22517998136852480, 18155135997837312, 4644337115725824, 18023194602504192, 4512395720392704, 149533581377536, 18014415689351168, 4503616807239680, 140754668224512, 8813272891392, 18014398543036416, 4503599660924928, 140737521909760, 8796126576640, 17213423616, 18014398509547520, 4503599627436032, 140737488420864, 8796093087744, 17179934720, 33619968), (45035996273704960, 36046389205008384, 9024791440785408, 36028831378702336, 9007233614479360, 17626545782784, 36028797086072832, 9007199321849856, 17592253153280, 34426847232, 36028797019095040, 9007199254872064, 17592186175488, 34359869440, 67239936, 36028797018964224, 9007199254741248, 17592186044672, 34359738624, 67109120, 131328), (18049582881570816, 18014467228958720, 35253091565568, 18014398643699712, 35184506306560, 68853694464, 18014398509744128, 35184372350976, 68719738880, 134479872, 18014398509482496, 35184372089344, 68719477248, 134218240, 262656, 18014398509481985, 35184372088833, 68719476737, 134217729, 262145, 513))
rook_pins = ((72339069014638592, 72058693549555712, 282574488338432, 72057598332895232, 281479271677952, 1103806595072, 72057594054705152, 281474993487872, 1099528404992, 4311744512, 72057594037993472, 281474976776192, 1099511693312, 4295032832, 16842752, 72057594037928192, 281474976710912, 1099511628032, 4294967552, 16777472, 65792, 72057594037928064, 281474976710784, 1099511627904, 4294967424, 16777344, 65664, 384, 72057594037928000, 281474976710720, 1099511627840, 4294967360, 16777280, 65600, 320, 192, 72057594037927968, 281474976710688, 1099511627808, 4294967328, 16777248, 65568, 288, 160, 96, 72057594037927952, 281474976710672, 1099511627792, 4294967312, 16777232, 65552, 272, 144, 80, 48, 72057594037927944, 281474976710664, 1099511627784, 4294967304, 16777224, 65544, 264, 136, 72, 40, 24, 72057594037927940, 281474976710660, 1099511627780, 4294967300, 16777220, 65540, 260, 132, 68, 36, 20, 12, 72057594037927938, 281474976710658, 1099511627778, 4294967298, 16777218, 65538, 258, 130, 66, 34, 18, 10, 6), (144678138029277184, 144117387099111424, 565148976676864, 144115196665790464, 562958543355904, 2207613190144, 144115188109410304, 562949986975744, 2199056809984, 8623489024, 144115188075986944, 562949953552384, 2199023386624, 8590065664, 33685504, 144115188075856384, 562949953421824, 2199023256064, 8589935104, 33554944, 131584, 144115188075856000, 562949953421440, 2199023255680, 8589934720, 33554560, 131200, 640, 144115188075855936, 562949953421376, 2199023255616, 8589934656, 33554496, 131136, 576, 192, 144115188075855904, 562949953421344, 2199023255584, 8589934624, 33554464, 131104, 544, 160, 96, 144115188075855888, 562949953421328, 2199023255568, 8589934608, 33554448, 131088, 528, 144, 80, 48, 144115188075855880, 562949953421320, 2199023255560, 8589934600, 33554440, 131080, 520, 136, 72, 40, 24, 144115188075855876, 562949953421316, 2199023255556, 8589934596, 33554436, 131076, 516, 132, 68, 36, 20, 12, 144115188075855873, 562949953421313, 2199023255553, 8589934593, 33554433, 131073, 513, 129, 65, 33, 17, 9, 5), (289356276058554368, 288234774198222848, 1130297953353728, 288230393331580928, 1125917086711808, 4415226380288, 288230376218820608, 1125899973951488, 4398113619968, 17246978048, 288230376151973888, 1125899907104768, 4398046773248, 17180131328, 67371008, 288230376151712768, 1125899906843648, 4398046512128, 17179870208, 67109888, 263168, 288230376151711872, 1125899906842752, 4398046511232, 17179869312, 67108992, 262272, 1152, 288230376151711808, 1125899906842688, 4398046511168, 17179869248, 67108928, 262208, 1088, 192, 288230376151711776, 1125899906842656, 4398046511136, 17179869216, 67108896, 262176, 1056, 160, 96, 288230376151711760, 1125899906842640, 4398046511120, 17179869200, 67108880, 262160, 1040, 144, 80, 48, 288230376151711752, 1125899906842632, 4398046511112, 17179869192, 67108872, 262152, 1032, 136, 72, 40, 24, 288230376151711746, 1125899906842626, 4398046511106, 17179869186, 67108866, 262146, 1026, 130, 66, 34, 18, 10, 288230376151711745, 1125899906842625, 4398046511105, 17179869185, 67108865, 262145, 1025, 129, 65, 33, 17, 9, 3), (578712552117108736, 576469548396445696, 2260595906707456, 576460786663161856, 2251834173423616, 8830452760576, 576460752437641216, 2251799947902976, 8796227239936, 34493956096, 576460752303947776, 2251799814209536, 8796093546496, 34360262656, 134742016, 576460752303425536, 2251799813687296, 8796093024256, 34359740416, 134219776, 526336, 576460752303423616, 2251799813685376, 8796093022336, 34359738496, 134217856, 524416, 2176, 576460752303423552, 2251799813685312, 8796093022272, 34359738432, 134217792, 524352, 2112, 192, 576460752303423520, 2251799813685280, 8796093022240, 34359738400, 134217760, 524320, 2080, 160, 96, 576460752303423504, 2251799813685264, 8796093022224, 34359738384, 134217744, 524304, 2064, 144, 80, 48, 576460752303423492, 2251799813685252, 8796093022212, 34359738372, 134217732, 524292, 2052, 132, 68, 36, 20, 576460752303423490, 2251799813685250, 8796093022210, 34359738370, 134217730, 524290, 2050, 130, 66, 34, 18, 6, 576460752303423489, 2251799813685249, 8796093022209, 34359738369, 134217729, 524289, 2049, 129, 65, 33, 17, 5, 3), (1157425104234217472, 1152939096792891392, 4521191813414912, 1152921573326323712, 4503668346847232, 17660905521152, 1152921504875282432, 4503599895805952, 17592454479872, 68987912192, 1152921504607895552, 4503599628419072, 17592187092992, 68720525312, 269484032, 1152921504606851072, 4503599627374592, 17592186048512, 68719480832, 268439552, 1052672, 1152921504606847104, 4503599627370624, 17592186044544, 68719476864, 268435584, 1048704, 4224, 1152921504606847040, 4503599627370560, 17592186044480, 68719476800, 268435520, 1048640, 4160, 192, 1152921504606847008, 4503599627370528, 17592186044448, 68719476768, 268435488, 1048608, 4128, 160, 96, 1152921504606846984, 4503599627370504, 17592186044424, 68719476744, 268435464, 1048584, 4104, 136, 72, 40, 1152921504606846980, 4503599627370500, 17592186044420, 68719476740, 268435460, 1048580, 4100, 132, 68, 36, 12, 1152921504606846978, 4503599627370498, 17592186044418, 68719476738, 268435458, 1048578, 4098, 130, 66, 34, 10, 6, 1152921504606846977, 4503599627370497, 17592186044417, 68719476737, 268435457, 1048577, 4097, 129, 65, 33, 9, 5, 3), (2314850208468434944, 2305878193585782784, 9042383626829824, 2305843146652647424, 9007336693694464, 35321811042304, 2305843009750564864, 9007199791611904, 35184908959744, 137975824384, 2305843009215791104, 9007199256838144, 35184374185984, 137441050624, 538968064, 2305843009213702144, 9007199254749184, 35184372097024, 137438961664, 536879104, 2105344, 2305843009213694080, 9007199254741120, 35184372088960, 137438953600, 536871040, 2097280, 8320, 2305843009213694016, 9007199254741056, 35184372088896, 137438953536, 536870976, 2097216, 8256, 192, 2305843009213693968, 9007199254741008, 35184372088848, 137438953488, 536870928, 2097168, 8208, 144, 80, 2305843009213693960, 9007199254741000, 35184372088840, 137438953480, 536870920, 2097160, 8200, 136, 72, 24, 2305843009213693956, 9007199254740996, 35184372088836, 137438953476, 536870916, 2097156, 8196, 132, 68, 20, 12, 2305843009213693954, 9007199254740994, 35184372088834, 137438953474, 536870914, 2097154, 8194, 130, 66, 18, 10, 6, 2305843009213693953, 9007199254740993, 35184372088833, 137438953473, 536870913, 2097153, 8193, 129, 65, 17, 9, 5, 3), (4629700416936869888, 4611756387171565568, 18084767253659648, 4611686293305294848, 18014673387388928, 70643622084608, 4611686019501129728, 18014399583223808, 70369817919488, 275951648768, 4611686018431582208, 18014398513676288, 70368748371968, 274882101248, 1077936128, 4611686018427404288, 18014398509498368, 70368744194048, 274877923328, 1073758208, 4210688, 4611686018427388032, 18014398509482112, 70368744177792, 274877907072, 1073741952, 4194432, 16512, 4611686018427387936, 18014398509482016, 70368744177696, 274877906976, 1073741856, 4194336, 16416, 160, 4611686018427387920, 18014398509482000, 70368744177680, 274877906960, 1073741840, 4194320, 16400, 144, 48, 4611686018427387912, 18014398509481992, 70368744177672, 274877906952, 1073741832, 4194312, 16392, 136, 40, 24, 4611686018427387908, 18014398509481988, 70368744177668, 274877906948, 1073741828, 4194308, 16388, 132, 36, 20, 12, 4611686018427387906, 18014398509481986, 70368744177666, 274877906946, 1073741826, 4194306, 16386, 130, 34, 18, 10, 6, 4611686018427387905, 18014398509481985, 70368744177665, 274877906945, 1073741825, 4194305, 16385, 129, 33, 17, 9, 5, 3), (9259400833873739776, 9223512774343131136, 36169534507319296, 9223372586610589696, 36029346774777856, 141287244169216, 9223372039002259456, 36028799166447616, 140739635838976, 551903297536, 9223372036863164416, 36028797027352576, 140737496743936, 549764202496, 2155872256, 9223372036854808576, 36028797018996736, 140737488388096, 549755846656, 2147516416, 8421376, 9223372036854775872, 36028797018964032, 140737488355392, 549755813952, 2147483712, 8388672, 32832, 9223372036854775840, 36028797018964000, 140737488355360, 549755813920, 2147483680, 8388640, 32800, 96, 9223372036854775824, 36028797018963984, 140737488355344, 549755813904, 2147483664, 8388624, 32784, 80, 48, 9223372036854775816, 36028797018963976, 140737488355336, 549755813896, 2147483656, 8388616, 32776, 72, 40, 24, 9223372036854775812, 36028797018963972, 140737488355332, 549755813892, 2147483652, 8388612, 32772, 68, 36, 20, 12, 9223372036854775810, 36028797018963970, 140737488355330, 549755813890, 2147483650, 8388610, 32770, 66, 34, 18, 10, 6, 9223372036854775809, 36028797018963969, 140737488355329, 549755813889, 2147483649, 8388609, 32769, 65, 33, 17, 9, 5, 3), (72339069014638592, 72058693549555712, 282574488338432, 72057598332895232, 281479271677952, 1103806595072, 72057594054705152, 281474993487872, 1099528404992, 4311744512, 72057594037993472, 281474976776192, 1099511693312, 4295032832, 16842752, 72057594037960704, 281474976743424, 1099511660544, 4295000064, 16809984, 98304, 72057594037944320, 281474976727040, 1099511644160, 4294983680, 16793600, 81920, 49152, 72057594037936128, 281474976718848, 1099511635968, 4294975488, 16785408, 73728, 40960, 24576, 72057594037932032, 281474976714752, 1099511631872, 4294971392, 16781312, 69632, 36864, 20480, 12288, 72057594037929984, 281474976712704, 1099511629824, 4294969344, 16779264, 67584, 34816, 18432, 10240, 6144, 72057594037928960, 281474976711680, 1099511628800, 4294968320, 16778240, 66560, 33792, 17408, 9216, 5120, 3072, 72057594037928448, 281474976711168, 1099511628288, 4294967808, 16777728, 66048, 33280, 16896, 8704, 4608, 2560, 1536, 72057594037927937, 281474976710657, 1099511627777, 4294967297, 16777217, 65537, 32769, 16385, 8193, 4097, 2049, 1025, 513), (144678138029277184, 144117387099111424, 565148976676864, 144115196665790464, 562958543355904, 2207613190144, 144115188109410304, 562949986975744, 2199056809984, 8623489024, 144115188075986944, 562949953552384, 2199023386624, 8590065664, 33685504, 144115188075888640, 562949953454080, 2199023288320, 8589967360, 33587200, 163840, 144115188075872256, 562949953437696, 2199023271936, 8589950976, 33570816, 147456, 49152, 144115188075864064, 562949953429504, 2199023263744, 8589942784, 33562624, 139264, 40960, 24576, 144115188075859968, 562949953425408, 2199023259648, 8589938688, 33558528, 135168, 36864, 20480, 12288, 144115188075857920, 562949953423360, 2199023257600, 8589936640, 33556480, 133120, 34816, 18432, 10240, 6144, 144115188075856896, 562949953422336, 2199023256576, 8589935616, 33555456, 132096, 33792, 17408, 9216, 5120, 3072, 144115188075856128, 562949953421568, 2199023255808, 8589934848, 33554688, 131328, 33024, 16640, 8448, 4352, 2304, 1280, 144115188075855874, 562949953421314, 2199023255554, 8589934594, 33554434, 131074, 32770, 16386, 8194, 4098, 2050, 1026, 258), (289356276058554368, 288234774198222848, 1130297953353728, 288230393331580928, 1125917086711808, 4415226380288, 288230376218820608, 1125899973951488, 4398113619968, 17246978048, 288230376151973888, 1125899907104768, 4398046773248, 17180131328, 67371008, 288230376151744512, 1125899906875392, 4398046543872, 17179901952, 67141632, 294912, 288230376151728128, 1125899906859008, 4398046527488, 17179885568, 67125248, 278528, 49152, 288230376151719936, 1125899906850816, 4398046519296, 17179877376, 67117056, 270336, 40960, 24576, 288230376151715840, 1125899906846720, 4398046515200, 17179873280, 67112960, 266240, 36864, 20480, 12288, 288230376151713792, 1125899906844672, 4398046513152, 17179871232, 67110912, 264192, 34816, 18432, 10240, 6144, 288230376151712256, 1125899906843136, 4398046511616, 17179869696, 67109376, 262656, 33280, 16896, 8704, 4608, 2560, 288230376151712000, 1125899906842880, 4398046511360, 17179869440, 67109120, 262400, 33024, 16640, 8448, 4352, 2304, 768, 288230376151711748, 1125899906842628, 4398046511108, 17179869188, 67108868, 262148, 32772, 16388, 8196, 4100, 2052, 516, 260), (578712552117108736, 576469548396445696, 2260595906707456, 576460786663161856, 2251834173423616, 8830452760576, 576460752437641216, 2251799947902976, 8796227239936, 34493956096, 576460752303947776, 2251799814209536, 8796093546496, 34360262656, 134742016, 576460752303456256, 2251799813718016, 8796093054976, 34359771136, 134250496, 557056, 576460752303439872, 2251799813701632, 8796093038592, 34359754752, 134234112, 540672, 49152, 576460752303431680, 2251799813693440, 8796093030400, 34359746560, 134225920, 532480, 40960, 24576, 576460752303427584, 2251799813689344, 8796093026304, 34359742464, 134221824, 528384, 36864, 20480, 12288, 576460752303424512, 2251799813686272, 8796093023232, 34359739392, 134218752, 525312, 33792, 17408, 9216, 5120, 576460752303424000, 2251799813685760, 8796093022720, 34359738880, 134218240, 524800, 33280, 16896, 8704, 4608, 1536, 576460752303423744, 2251799813685504, 8796093022464, 34359738624, 134217984, 524544, 33024, 16640, 8448, 4352, 1280, 768, 576460752303423496, 2251799813685256, 8796093022216, 34359738376, 134217736, 524296, 32776, 16392, 8200, 4104, 1032, 520, 264), (1157425104234217472, 1152939096792891392, 4521191813414912, 1152921573326323712, 4503668346847232, 17660905521152, 1152921504875282432, 4503599895805952, 17592454479872, 68987912192, 1152921504607895552, 4503599628419072, 17592187092992, 68720525312, 269484032, 1152921504606879744, 4503599627403264, 17592186077184, 68719509504, 268468224, 1081344, 1152921504606863360, 4503599627386880, 17592186060800, 68719493120, 268451840, 1064960, 49152, 1152921504606855168, 4503599627378688, 17592186052608, 68719484928, 268443648, 1056768, 40960, 24576, 1152921504606849024, 4503599627372544, 17592186046464, 68719478784, 268437504, 1050624, 34816, 18432, 10240, 1152921504606848000, 4503599627371520, 17592186045440, 68719477760, 268436480, 1049600, 33792, 17408, 9216, 3072, 1152921504606847488, 4503599627371008, 17592186044928, 68719477248, 268435968, 1049088, 33280, 16896, 8704, 2560, 1536, 1152921504606847232, 4503599627370752, 17592186044672, 68719476992, 268435712, 1048832, 33024, 16640, 8448, 2304, 1280, 768, 1152921504606846992, 4503599627370512, 17592186044432, 68719476752, 268435472, 1048592, 32784, 16400, 8208, 2064, 1040, 528, 272), (2314850208468434944, 2305878193585782784, 9042383626829824, 2305843146652647424, 9007336693694464, 35321811042304, 2305843009750564864, 9007199791611904, 35184908959744, 137975824384, 2305843009215791104, 9007199256838144, 35184374185984, 137441050624, 538968064, 2305843009213726720, 9007199254773760, 35184372121600, 137438986240, 536903680, 2129920, 2305843009213710336, 9007199254757376, 35184372105216, 137438969856, 536887296, 2113536, 49152, 2305843009213698048, 9007199254745088, 35184372092928, 137438957568, 536875008, 2101248, 36864, 20480, 2305843009213696000, 9007199254743040, 35184372090880, 137438955520, 536872960, 2099200, 34816, 18432, 6144, 2305843009213694976, 9007199254742016, 35184372089856, 137438954496, 536871936, 2098176, 33792, 17408, 5120, 3072, 2305843009213694464, 9007199254741504, 35184372089344, 137438953984, 536871424, 2097664, 33280, 16896, 4608, 2560, 1536, 2305843009213694208, 9007199254741248, 35184372089088, 137438953728, 536871168, 2097408, 33024, 16640, 4352, 2304, 1280, 768, 2305843009213693984, 9007199254741024, 35184372088864, 137438953504, 536870944, 2097184, 32800, 16416, 4128, 2080, 1056, 544, 288), (4629700416936869888, 4611756387171565568, 18084767253659648, 4611686293305294848, 18014673387388928, 70643622084608, 4611686019501129728, 18014399583223808, 70369817919488, 275951648768, 4611686018431582208, 18014398513676288, 70368748371968, 274882101248, 1077936128, 4611686018427420672, 18014398509514752, 70368744210432, 274877939712, 1073774592, 4227072, 4611686018427396096, 18014398509490176, 70368744185856, 274877915136, 1073750016, 4202496, 40960, 4611686018427392000, 18014398509486080, 70368744181760, 274877911040, 1073745920, 4198400, 36864, 12288, 4611686018427389952, 18014398509484032, 70368744179712, 274877908992, 1073743872, 4196352, 34816, 10240, 6144, 4611686018427388928, 18014398509483008, 70368744178688, 274877907968, 1073742848, 4195328, 33792, 9216, 5120, 3072, 4611686018427388416, 18014398509482496, 70368744178176, 274877907456, 1073742336, 4194816, 33280, 8704, 4608, 2560, 1536, 4611686018427388160, 18014398509482240, 70368744177920, 274877907200, 1073742080, 4194560, 33024, 8448, 4352, 2304, 1280, 768, 4611686018427387968, 18014398509482048, 70368744177728, 274877907008, 1073741888, 4194368, 32832, 8256, 4160, 2112, 1088, 576, 320), (9259400833873739776, 9223512774343131136, 36169534507319296, 9223372586610589696, 36029346774777856, 141287244169216, 9223372039002259456, 36028799166447616, 140739635838976, 551903297536, 9223372036863164416, 36028797027352576, 140737496743936, 549764202496, 2155872256, 9223372036854792192, 36028797018980352, 140737488371712, 549755830272, 2147500032, 8404992, 9223372036854784000, 36028797018972160, 140737488363520, 549755822080, 2147491840, 8396800, 24576, 9223372036854779904, 36028797018968064, 140737488359424, 549755817984, 2147487744, 8392704, 20480, 12288, 9223372036854777856, 36028797018966016, 140737488357376, 549755815936, 2147485696, 8390656, 18432, 10240, 6144, 9223372036854776832, 36028797018964992, 140737488356352, 549755814912, 2147484672, 8389632, 17408, 9216, 5120, 3072, 9223372036854776320, 36028797018964480, 140737488355840, 549755814400, 2147484160, 8389120, 16896, 8704, 4608, 2560, 1536, 9223372036854776064, 36028797018964224, 140737488355584, 549755814144, 2147483904, 8388864, 16640, 8448, 4352, 2304, 1280, 768, 9223372036854775936, 36028797018964096, 140737488355456, 549755814016, 2147483776, 8388736, 16512, 8320, 4224, 2176, 1152, 640, 384), (72339069014638592, 72058693549555712, 282574488338432, 72057598332895232, 281479271677952, 1103806595072, 72057594054705152, 281474993487872, 1099528404992, 4311744512, 72057594046316544, 281474985099264, 1099520016384, 4303355904, 25165824, 72057594042122240, 281474980904960, 1099515822080, 4299161600, 20971520, 12582912, 72057594040025088, 281474978807808, 1099513724928, 4297064448, 18874368, 10485760, 6291456, 72057594038976512, 281474977759232, 1099512676352, 4296015872, 17825792, 9437184, 5242880, 3145728, 72057594038452224, 281474977234944, 1099512152064, 4295491584, 17301504, 8912896, 4718592, 2621440, 1572864, 72057594038190080, 281474976972800, 1099511889920, 4295229440, 17039360, 8650752, 4456448, 2359296, 1310720, 786432, 72057594038059008, 281474976841728, 1099511758848, 4295098368, 16908288, 8519680, 4325376, 2228224, 1179648, 655360, 393216, 72057594037928192, 281474976710912, 1099511628032, 4294967552, 16777472, 8388864, 4194560, 2097408, 1048832, 524544, 262400, 131328, 72057594037927937, 281474976710657, 1099511627777, 4294967297, 16777217, 8388609, 4194305, 2097153, 1048577, 524289, 262145, 131073, 257), (144678138029277184, 144117387099111424, 565148976676864, 144115196665790464, 562958543355904, 2207613190144, 144115188109410304, 562949986975744, 2199056809984, 8623489024, 144115188084244480, 562949961809920, 2199031644160, 8598323200, 41943040, 144115188080050176, 562949957615616, 2199027449856, 8594128896, 37748736, 12582912, 144115188077953024, 562949955518464, 2199025352704, 8592031744, 35651584, 10485760, 6291456, 144115188076904448, 562949954469888, 2199024304128, 8590983168, 34603008, 9437184, 5242880, 3145728, 144115188076380160, 562949953945600, 2199023779840, 8590458880, 34078720, 8912896, 4718592, 2621440, 1572864, 144115188076118016, 562949953683456, 2199023517696, 8590196736, 33816576, 8650752, 4456448, 2359296, 1310720, 786432, 144115188075921408, 562949953486848, 2199023321088, 8590000128, 33619968, 8454144, 4259840, 2162688, 1114112, 589824, 327680, 144115188075856384, 562949953421824, 2199023256064, 8589935104, 33554944, 8389120, 4194816, 2097664, 1049088, 524800, 262656, 66048, 144115188075855874, 562949953421314, 2199023255554, 8589934594, 33554434, 8388610, 4194306, 2097154, 1048578, 524290, 262146, 65538, 514), (289356276058554368, 288234774198222848, 1130297953353728, 288230393331580928, 1125917086711808, 4415226380288, 288230376218820608, 1125899973951488, 4398113619968, 17246978048, 288230376160100352, 1125899915231232, 4398054899712, 17188257792, 75497472, 288230376155906048, 1125899911036928, 4398050705408, 17184063488, 71303168, 12582912, 288230376153808896, 1125899908939776, 4398048608256, 17181966336, 69206016, 10485760, 6291456, 288230376152760320, 1125899907891200, 4398047559680, 17180917760, 68157440, 9437184, 5242880, 3145728, 288230376152236032, 1125899907366912, 4398047035392, 17180393472, 67633152, 8912896, 4718592, 2621440, 1572864, 288230376151842816, 1125899906973696, 4398046642176, 17180000256, 67239936, 8519680, 4325376, 2228224, 1179648, 655360, 288230376151777280, 1125899906908160, 4398046576640, 17179934720, 67174400, 8454144, 4259840, 2162688, 1114112, 589824, 196608, 288230376151712768, 1125899906843648, 4398046512128, 17179870208, 67109888, 8389632, 4195328, 2098176, 1049600, 525312, 132096, 66560, 288230376151711748, 1125899906842628, 4398046511108, 17179869188, 67108868, 8388612, 4194308, 2097156, 1048580, 524292, 131076, 65540, 1028), (578712552117108736, 576469548396445696, 2260595906707456, 576460786663161856, 2251834173423616, 8830452760576, 576460752437641216, 2251799947902976, 8796227239936, 34493956096, 576460752311812096, 2251799822073856, 8796101410816, 34368126976, 142606336, 576460752307617792, 2251799817879552, 8796097216512, 34363932672, 138412032, 12582912, 576460752305520640, 2251799815782400, 8796095119360, 34361835520, 136314880, 10485760, 6291456, 576460752304472064, 2251799814733824, 8796094070784, 34360786944, 135266304, 9437184, 5242880, 3145728, 576460752303685632, 2251799813947392, 8796093284352, 34360000512, 134479872, 8650752, 4456448, 2359296, 1310720, 576460752303554560, 2251799813816320, 8796093153280, 34359869440, 134348800, 8519680, 4325376, 2228224, 1179648, 393216, 576460752303489024, 2251799813750784, 8796093087744, 34359803904, 134283264, 8454144, 4259840, 2162688, 1114112, 327680, 196608, 576460752303425536, 2251799813687296, 8796093024256, 34359740416, 134219776, 8390656, 4196352, 2099200, 1050624, 264192, 133120, 67584, 576460752303423496, 2251799813685256, 8796093022216, 34359738376, 134217736, 8388616, 4194312, 2097160, 1048584, 262152, 131080, 65544, 2056), (1157425104234217472, 1152939096792891392, 4521191813414912, 1152921573326323712, 4503668346847232, 17660905521152, 1152921504875282432, 4503599895805952, 17592454479872, 68987912192, 1152921504615235584, 4503599635759104, 17592194433024, 68727865344, 276824064, 1152921504611041280, 4503599631564800, 17592190238720, 68723671040, 272629760, 12582912, 1152921504608944128, 4503599629467648, 17592188141568, 68721573888, 270532608, 10485760, 6291456, 1152921504607371264, 4503599627894784, 17592186568704, 68720001024, 268959744, 8912896, 4718592, 2621440, 1152921504607109120, 4503599627632640, 17592186306560, 68719738880, 268697600, 8650752, 4456448, 2359296, 786432, 1152921504606978048, 4503599627501568, 17592186175488, 68719607808, 268566528, 8519680, 4325376, 2228224, 655360, 393216, 1152921504606912512, 4503599627436032, 17592186109952, 68719542272, 268500992, 8454144, 4259840, 2162688, 589824, 327680, 196608, 1152921504606851072, 4503599627374592, 17592186048512, 68719480832, 268439552, 8392704, 4198400, 2101248, 528384, 266240, 135168, 69632, 1152921504606846992, 4503599627370512, 17592186044432, 68719476752, 268435472, 8388624, 4194320, 2097168, 524304, 262160, 131088, 65552, 4112), (2314850208468434944, 2305878193585782784, 9042383626829824, 2305843146652647424, 9007336693694464, 35321811042304, 2305843009750564864, 9007199791611904, 35184908959744, 137975824384, 2305843009222082560, 9007199263129600, 35184380477440, 137447342080, 545259520, 2305843009217888256, 9007199258935296, 35184376283136, 137443147776, 541065216, 12582912, 2305843009214742528, 9007199255789568, 35184373137408, 137440002048, 537919488, 9437184, 5242880, 2305843009214218240, 9007199255265280, 35184372613120, 137439477760, 537395200, 8912896, 4718592, 1572864, 2305843009213956096, 9007199255003136, 35184372350976, 137439215616, 537133056, 8650752, 4456448, 1310720, 786432, 2305843009213825024, 9007199254872064, 35184372219904, 137439084544, 537001984, 8519680, 4325376, 1179648, 655360, 393216, 2305843009213759488, 9007199254806528, 35184372154368, 137439019008, 536936448, 8454144, 4259840, 1114112, 589824, 327680, 196608, 2305843009213702144, 9007199254749184, 35184372097024, 137438961664, 536879104, 8396800, 4202496, 1056768, 532480, 270336, 139264, 73728, 2305843009213693984, 9007199254741024, 35184372088864, 137438953504, 536870944, 8388640, 4194336, 1048608, 524320, 262176, 131104, 65568, 8224), (4629700416936869888, 4611756387171565568, 18084767253659648, 4611686293305294848, 18014673387388928, 70643622084608, 4611686019501129728, 18014399583223808, 70369817919488, 275951648768, 4611686018435776512, 18014398517870592, 70368752566272, 274886295552, 1082130432, 4611686018429485056, 18014398511579136, 70368746274816, 274880004096, 1075838976, 10485760, 4611686018428436480, 18014398510530560, 70368745226240, 274878955520, 1074790400, 9437184, 3145728, 4611686018427912192, 18014398510006272, 70368744701952, 274878431232, 1074266112, 8912896, 2621440, 1572864, 4611686018427650048, 18014398509744128, 70368744439808, 274878169088, 1074003968, 8650752, 2359296, 1310720, 786432, 4611686018427518976, 18014398509613056, 70368744308736, 274878038016, 1073872896, 8519680, 2228224, 1179648, 655360, 393216, 4611686018427453440, 18014398509547520, 70368744243200, 274877972480, 1073807360, 8454144, 2162688, 1114112, 589824, 327680, 196608, 4611686018427404288, 18014398509498368, 70368744194048, 274877923328, 1073758208, 8404992, 2113536, 1064960, 540672, 278528, 147456, 81920, 4611686018427387968, 18014398509482048, 70368744177728, 274877907008, 1073741888, 8388672, 2097216, 1048640, 524352, 262208, 131136, 65600, 16448), (9259400833873739776, 9223512774343131136, 36169534507319296, 9223372586610589696, 36029346774777856, 141287244169216, 9223372039002259456, 36028799166447616, 140739635838976, 551903297536, 9223372036858970112, 36028797023158272, 140737492549632, 549760008192, 2151677952, 9223372036856872960, 36028797021061120, 140737490452480, 549757911040, 2149580800, 6291456, 9223372036855824384, 36028797020012544, 140737489403904, 549756862464, 2148532224, 5242880, 3145728, 9223372036855300096, 36028797019488256, 140737488879616, 549756338176, 2148007936, 4718592, 2621440, 1572864, 9223372036855037952, 36028797019226112, 140737488617472, 549756076032, 2147745792, 4456448, 2359296, 1310720, 786432, 9223372036854906880, 36028797019095040, 140737488486400, 549755944960, 2147614720, 4325376, 2228224, 1179648, 655360, 393216, 9223372036854841344, 36028797019029504, 140737488420864, 549755879424, 2147549184, 4259840, 2162688, 1114112, 589824, 327680, 196608, 9223372036854808576, 36028797018996736, 140737488388096, 549755846656, 2147516416, 4227072, 2129920, 1081344, 557056, 294912, 163840, 98304, 9223372036854775936, 36028797018964096, 140737488355456, 549755814016, 2147483776, 4194432, 2097280, 1048704, 524416, 262272, 131200, 65664, 32896), (72339069014638592, 72058693549555712, 282574488338432, 72057598332895232, 281479271677952, 1103806595072, 72057596185411584, 281477124194304, 1101659111424, 6442450944, 72057595111669760, 281476050452480, 1100585369600, 5368709120, 3221225472, 72057594574798848, 281475513581568, 1100048498688, 4831838208, 2684354560, 1610612736, 72057594306363392, 281475245146112, 1099780063232, 4563402752, 2415919104, 1342177280, 805306368, 72057594172145664, 281475110928384, 1099645845504, 4429185024, 2281701376, 1207959552, 671088640, 402653184, 72057594105036800, 281475043819520, 1099578736640, 4362076160, 2214592512, 1140850688, 603979776, 335544320, 201326592, 72057594071482368, 281475010265088, 1099545182208, 4328521728, 2181038080, 1107296256, 570425344, 301989888, 167772160, 100663296, 72057594037993472, 281474976776192, 1099511693312, 4295032832, 2147549184, 1073807360, 536936448, 268500992, 134283264, 67174400, 33619968, 72057594037928192, 281474976710912, 1099511628032, 4294967552, 2147483904, 1073742080, 536871168, 268435712, 134217984, 67109120, 33554688, 65792, 72057594037927937, 281474976710657, 1099511627777, 4294967297, 2147483649, 1073741825, 536870913, 268435457, 134217729, 67108865, 33554433, 65537, 257), (144678138029277184, 144117387099111424, 565148976676864, 144115196665790464, 562958543355904, 2207613190144, 144115190223339520, 562952100904960, 2201170739200, 10737418240, 144115189149597696, 562951027163136, 2200096997376, 9663676416, 3221225472, 144115188612726784, 562950490292224, 2199560126464, 9126805504, 2684354560, 1610612736, 144115188344291328, 562950221856768, 2199291691008, 8858370048, 2415919104, 1342177280, 805306368, 144115188210073600, 562950087639040, 2199157473280, 8724152320, 2281701376, 1207959552, 671088640, 402653184, 144115188142964736, 562950020530176, 2199090364416, 8657043456, 2214592512, 1140850688, 603979776, 335544320, 201326592, 144115188092633088, 562949970198528, 2199040032768, 8606711808, 2164260864, 1090519040, 553648128, 285212672, 150994944, 83886080, 144115188075986944, 562949953552384, 2199023386624, 8590065664, 2147614720, 1073872896, 537001984, 268566528, 134348800, 67239936, 16908288, 144115188075856384, 562949953421824, 2199023256064, 8589935104, 2147484160, 1073742336, 536871424, 268435968, 134218240, 67109376, 16777728, 131584, 144115188075855874, 562949953421314, 2199023255554, 8589934594, 2147483650, 1073741826, 536870914, 268435458, 134217730, 67108866, 16777218, 131074, 514), (289356276058554368, 288234774198222848, 1130297953353728, 288230393331580928, 1125917086711808, 4415226380288, 288230378299195392, 1125902054326272, 4400193994752, 19327352832, 288230377225453568, 1125900980584448, 4399120252928, 18253611008, 3221225472, 288230376688582656, 1125900443713536, 4398583382016, 17716740096, 2684354560, 1610612736, 288230376420147200, 1125900175278080, 4398314946560, 17448304640, 2415919104, 1342177280, 805306368, 288230376285929472, 1125900041060352, 4398180728832, 17314086912, 2281701376, 1207959552, 671088640, 402653184, 288230376185266176, 1125899940397056, 4398080065536, 17213423616, 2181038080, 1107296256, 570425344, 301989888, 167772160, 288230376168488960, 1125899923619840, 4398063288320, 17196646400, 2164260864, 1090519040, 553648128, 285212672, 150994944, 50331648, 288230376151973888, 1125899907104768, 4398046773248, 17180131328, 2147745792, 1074003968, 537133056, 268697600, 134479872, 33816576, 17039360, 288230376151712768, 1125899906843648, 4398046512128, 17179870208, 2147484672, 1073742848, 536871936, 268436480, 134218752, 33555456, 16778240, 263168, 288230376151711748, 1125899906842628, 4398046511108, 17179869188, 2147483652, 1073741828, 536870916, 268435460, 134217732, 33554436, 16777220, 262148, 1028), (578712552117108736, 576469548396445696, 2260595906707456, 576460786663161856, 2251834173423616, 8830452760576, 576460754450907136, 2251801961168896, 8798240505856, 36507222016, 576460753377165312, 2251800887427072, 8797166764032, 35433480192, 3221225472, 576460752840294400, 2251800350556160, 8796629893120, 34896609280, 2684354560, 1610612736, 576460752571858944, 2251800082120704, 8796361457664, 34628173824, 2415919104, 1342177280, 805306368, 576460752370532352, 2251799880794112, 8796160131072, 34426847232, 2214592512, 1140850688, 603979776, 335544320, 576460752336977920, 2251799847239680, 8796126576640, 34393292800, 2181038080, 1107296256, 570425344, 301989888, 100663296, 576460752320200704, 2251799830462464, 8796109799424, 34376515584, 2164260864, 1090519040, 553648128, 285212672, 83886080, 50331648, 576460752303947776, 2251799814209536, 8796093546496, 34360262656, 2148007936, 1074266112, 537395200, 268959744, 67633152, 34078720, 17301504, 576460752303425536, 2251799813687296, 8796093024256, 34359740416, 2147485696, 1073743872, 536872960, 268437504, 67110912, 33556480, 16779264, 526336, 576460752303423496, 2251799813685256, 8796093022216, 34359738376, 2147483656, 1073741832, 536870920, 268435464, 67108872, 33554440, 16777224, 524296, 2056), (1157425104234217472, 1152939096792891392, 4521191813414912, 1152921573326323712, 4503668346847232, 17660905521152, 1152921506754330624, 4503601774854144, 17594333528064, 70866960384, 1152921505680588800, 4503600701112320, 17593259786240, 69793218560, 3221225472, 1152921505143717888, 4503600164241408, 17592722915328, 69256347648, 2684354560, 1610612736, 1152921504741064704, 4503599761588224, 17592320262144, 68853694464, 2281701376, 1207959552, 671088640, 1152921504673955840, 4503599694479360, 17592253153280, 68786585600, 2214592512, 1140850688, 603979776, 201326592, 1152921504640401408, 4503599660924928, 17592219598848, 68753031168, 2181038080, 1107296256, 570425344, 167772160, 100663296, 1152921504623624192, 4503599644147712, 17592202821632, 68736253952, 2164260864, 1090519040, 553648128, 150994944, 83886080, 50331648, 1152921504607895552, 4503599628419072, 17592187092992, 68720525312, 2148532224, 1074790400, 537919488, 135266304, 68157440, 34603008, 17825792, 1152921504606851072, 4503599627374592, 17592186048512, 68719480832, 2147487744, 1073745920, 536875008, 134221824, 67112960, 33558528, 16781312, 1052672, 1152921504606846992, 4503599627370512, 17592186044432, 68719476752, 2147483664, 1073741840, 536870928, 134217744, 67108880, 33554448, 16777232, 1048592, 4112), (2314850208468434944, 2305878193585782784, 9042383626829824, 2305843146652647424, 9007336693694464, 35321811042304, 2305843011361177600, 9007201402224640, 35186519572480, 139586437120, 2305843010287435776, 9007200328482816, 35185445830656, 138512695296, 3221225472, 2305843009482129408, 9007199523176448, 35184640524288, 137707388928, 2415919104, 1342177280, 2305843009347911680, 9007199388958720, 35184506306560, 137573171200, 2281701376, 1207959552, 402653184, 2305843009280802816, 9007199321849856, 35184439197696, 137506062336, 2214592512, 1140850688, 335544320, 201326592, 2305843009247248384, 9007199288295424, 35184405643264, 137472507904, 2181038080, 1107296256, 301989888, 167772160, 100663296, 2305843009230471168, 9007199271518208, 35184388866048, 137455730688, 2164260864, 1090519040, 285212672, 150994944, 83886080, 50331648, 2305843009215791104, 9007199256838144, 35184374185984, 137441050624, 2149580800, 1075838976, 270532608, 136314880, 69206016, 35651584, 18874368, 2305843009213702144, 9007199254749184, 35184372097024, 137438961664, 2147491840, 1073750016, 268443648, 134225920, 67117056, 33562624, 16785408, 2105344, 2305843009213693984, 9007199254741024, 35184372088864, 137438953504, 2147483680, 1073741856, 268435488, 134217760, 67108896, 33554464, 16777248, 2097184, 8224), (4629700416936869888, 4611756387171565568, 18084767253659648, 4611686293305294848, 18014673387388928, 70643622084608, 4611686020574871552, 18014400656965632, 70370891661312, 277025390592, 4611686018964258816, 18014399046352896, 70369281048576, 275414777856, 2684354560, 4611686018695823360, 18014398777917440, 70369012613120, 275146342400, 2415919104, 805306368, 4611686018561605632, 18014398643699712, 70368878395392, 275012124672, 2281701376, 671088640, 402653184, 4611686018494496768, 18014398576590848, 70368811286528, 274945015808, 2214592512, 603979776, 335544320, 201326592, 4611686018460942336, 18014398543036416, 70368777732096, 274911461376, 2181038080, 570425344, 301989888, 167772160, 100663296, 4611686018444165120, 18014398526259200, 70368760954880, 274894684160, 2164260864, 553648128, 285212672, 150994944, 83886080, 50331648, 4611686018431582208, 18014398513676288, 70368748371968, 274882101248, 2151677952, 541065216, 272629760, 138412032, 71303168, 37748736, 20971520, 4611686018427404288, 18014398509498368, 70368744194048, 274877923328, 2147500032, 536887296, 268451840, 134234112, 67125248, 33570816, 16793600, 4210688, 4611686018427387968, 18014398509482048, 70368744177728, 274877907008, 2147483712, 536870976, 268435520, 134217792, 67108928, 33554496, 16777280, 4194368, 16448), (9259400833873739776, 9223512774343131136, 36169534507319296, 9223372586610589696, 36029346774777856, 141287244169216, 9223372037928517632, 36028798092705792, 140738562097152, 550829555712, 9223372037391646720, 36028797555834880, 140738025226240, 550292684800, 1610612736, 9223372037123211264, 36028797287399424, 140737756790784, 550024249344, 1342177280, 805306368, 9223372036988993536, 36028797153181696, 140737622573056, 549890031616, 1207959552, 671088640, 402653184, 9223372036921884672, 36028797086072832, 140737555464192, 549822922752, 1140850688, 603979776, 335544320, 201326592, 9223372036888330240, 36028797052518400, 140737521909760, 549789368320, 1107296256, 570425344, 301989888, 167772160, 100663296, 9223372036871553024, 36028797035741184, 140737505132544, 549772591104, 1090519040, 553648128, 285212672, 150994944, 83886080, 50331648, 9223372036863164416, 36028797027352576, 140737496743936, 549764202496, 1082130432, 545259520, 276824064, 142606336, 75497472, 41943040, 25165824, 9223372036854808576, 36028797018996736, 140737488388096, 549755846656, 1073774592, 536903680, 268468224, 134250496, 67141632, 33587200, 16809984, 8421376, 9223372036854775936, 36028797018964096, 140737488355456, 549755814016, 1073741952, 536871040, 268435584, 134217856, 67108992, 33554560, 16777344, 8388736, 32896), (72339069014638592, 72058693549555712, 282574488338432, 72058143793741824, 282024732524544, 1649267441664, 72057868915834880, 281749854617600, 1374389534720, 824633720832, 72057731476881408, 281612415664128, 1236950581248, 687194767360, 412316860416, 72057662757404672, 281543696187392, 1168231104512, 618475290624, 343597383680, 206158430208, 72057628397666304, 281509336449024, 1133871366144, 584115552256, 309237645312, 171798691840, 103079215104, 72057611217797120, 281492156579840, 1116691496960, 566935683072, 292057776128, 154618822656, 85899345920, 51539607552, 72057602627862528, 281483566645248, 1108101562368, 558345748480, 283467841536, 146028888064, 77309411328, 42949672960, 25769803776, 72057594054705152, 281474993487872, 1099528404992, 549772591104, 274894684160, 137455730688, 68736253952, 34376515584, 17196646400, 8606711808, 72057594037993472, 281474976776192, 1099511693312, 549755879424, 274877972480, 137439019008, 68719542272, 34359803904, 17179934720, 8590000128, 16842752, 72057594037928192, 281474976710912, 1099511628032, 549755814144, 274877907200, 137438953728, 68719476992, 34359738624, 17179869440, 8589934848, 16777472, 65792, 72057594037927937, 281474976710657, 1099511627777, 549755813889, 274877906945, 137438953473, 68719476737, 34359738369, 17179869185, 8589934593, 16777217, 65537, 257), (144678138029277184, 144117387099111424, 565148976676864, 144115737831669760, 563499709235200, 2748779069440, 144115462953762816, 563224831328256, 2473901162496, 824633720832, 144115325514809344, 563087392374784, 2336462209024, 687194767360, 412316860416, 144115256795332608, 563018672898048, 2267742732288, 618475290624, 343597383680, 206158430208, 144115222435594240, 562984313159680, 2233382993920, 584115552256, 309237645312, 171798691840, 103079215104, 144115205255725056, 562967133290496, 2216203124736, 566935683072, 292057776128, 154618822656, 85899345920, 51539607552, 144115192370823168, 562954248388608, 2203318222848, 554050781184, 279172874240, 141733920768, 73014444032, 38654705664, 21474836480, 144115188109410304, 562949986975744, 2199056809984, 549789368320, 274911461376, 137472507904, 68753031168, 34393292800, 17213423616, 4328521728, 144115188075986944, 562949953552384, 2199023386624, 549755944960, 274878038016, 137439084544, 68719607808, 34359869440, 17180000256, 4295098368, 33685504, 144115188075856384, 562949953421824, 2199023256064, 549755814400, 274877907456, 137438953984, 68719477248, 34359738880, 17179869696, 4294967808, 33554944, 131584, 144115188075855874, 562949953421314, 2199023255554, 549755813890, 274877906946, 137438953474, 68719476738, 34359738370, 17179869186, 4294967298, 33554434, 131074, 514), (289356276058554368, 288234774198222848, 1130297953353728, 288230925907525632, 1126449662656512, 4947802324992, 288230651029618688, 1126174784749568, 4672924418048, 824633720832, 288230513590665216, 1126037345796096, 4535485464576, 687194767360, 412316860416, 288230444871188480, 1125968626319360, 4466765987840, 618475290624, 343597383680, 206158430208, 288230410511450112, 1125934266580992, 4432406249472, 584115552256, 309237645312, 171798691840, 103079215104, 288230384741646336, 1125908496777216, 4406636445696, 558345748480, 283467841536, 146028888064, 77309411328, 42949672960, 288230380446679040, 1125904201809920, 4402341478400, 554050781184, 279172874240, 141733920768, 73014444032, 38654705664, 12884901888, 288230376218820608, 1125899973951488, 4398113619968, 549822922752, 274945015808, 137506062336, 68786585600, 34426847232, 8657043456, 4362076160, 288230376151973888, 1125899907104768, 4398046773248, 549756076032, 274878169088, 137439215616, 68719738880, 34360000512, 8590196736, 4295229440, 67371008, 288230376151712768, 1125899906843648, 4398046512128, 549755814912, 274877907968, 137438954496, 68719477760, 34359739392, 8589935616, 4294968320, 67109888, 263168, 288230376151711748, 1125899906842628, 4398046511108, 549755813892, 274877906948, 137438953476, 68719476740, 34359738372, 8589934596, 4294967300, 67108868, 262148, 1028), (578712552117108736, 576469548396445696, 2260595906707456, 576461302059237376, 2252349569499136, 9345848836096, 576461027181330432, 2252074691592192, 9070970929152, 824633720832, 576460889742376960, 2251937252638720, 8933531975680, 687194767360, 412316860416, 576460821022900224, 2251868533161984, 8864812498944, 618475290624, 343597383680, 206158430208, 576460769483292672, 2251816993554432, 8813272891392, 566935683072, 292057776128, 154618822656, 85899345920, 576460760893358080, 2251808403619840, 8804682956800, 558345748480, 283467841536, 146028888064, 77309411328, 25769803776, 576460756598390784, 2251804108652544, 8800387989504, 554050781184, 279172874240, 141733920768, 73014444032, 21474836480, 12884901888, 576460752437641216, 2251799947902976, 8796227239936, 549890031616, 275012124672, 137573171200, 68853694464, 17314086912, 8724152320, 4429185024, 576460752303947776, 2251799814209536, 8796093546496, 549756338176, 274878431232, 137439477760, 68720001024, 17180393472, 8590458880, 4295491584, 134742016, 576460752303425536, 2251799813687296, 8796093024256, 549755815936, 274877908992, 137438955520, 68719478784, 17179871232, 8589936640, 4294969344, 134219776, 526336, 576460752303423496, 2251799813685256, 8796093022216, 549755813896, 274877906952, 137438953480, 68719476744, 17179869192, 8589934600, 4294967304, 134217736, 524296, 2056), (1157425104234217472, 1152939096792891392, 4521191813414912, 1152922054362660864, 4504149383184384, 18141941858304, 1152921779484753920, 4503874505277440, 17867063951360, 824633720832, 1152921642045800448, 4503737066323968, 17729624997888, 687194767360, 412316860416, 1152921538966585344, 4503633987108864, 17626545782784, 584115552256, 309237645312, 171798691840, 1152921521786716160, 4503616807239680, 17609365913600, 566935683072, 292057776128, 154618822656, 51539607552, 1152921513196781568, 4503608217305088, 17600775979008, 558345748480, 283467841536, 146028888064, 42949672960, 25769803776, 1152921508901814272, 4503603922337792, 17596481011712, 554050781184, 279172874240, 141733920768, 38654705664, 21474836480, 12884901888, 1152921504875282432, 4503599895805952, 17592454479872, 550024249344, 275146342400, 137707388928, 34628173824, 17448304640, 8858370048, 4563402752, 1152921504607895552, 4503599628419072, 17592187092992, 549756862464, 274878955520, 137440002048, 34360786944, 17180917760, 8590983168, 4296015872, 269484032, 1152921504606851072, 4503599627374592, 17592186048512, 549755817984, 274877911040, 137438957568, 34359742464, 17179873280, 8589938688, 4294971392, 268439552, 1052672, 1152921504606846992, 4503599627370512, 17592186044432, 549755813904, 274877906960, 137438953488, 34359738384, 17179869200, 8589934608, 4294967312, 268435472, 1048592, 4112), (2314850208468434944, 2305878193585782784, 9042383626829824, 2305843558969507840, 9007749010554880, 35734127902720, 2305843284091600896, 9007474132647936, 35459249995776, 824633720832, 2305843077933170688, 9007267974217728, 35253091565568, 618475290624, 343597383680, 2305843043573432320, 9007233614479360, 35218731827200, 584115552256, 309237645312, 103079215104, 2305843026393563136, 9007216434610176, 35201551958016, 566935683072, 292057776128, 85899345920, 51539607552, 2305843017803628544, 9007207844675584, 35192962023424, 558345748480, 283467841536, 77309411328, 42949672960, 25769803776, 2305843013508661248, 9007203549708288, 35188667056128, 554050781184, 279172874240, 73014444032, 38654705664, 21474836480, 12884901888, 2305843009750564864, 9007199791611904, 35184908959744, 550292684800, 275414777856, 69256347648, 34896609280, 17716740096, 9126805504, 4831838208, 2305843009215791104, 9007199256838144, 35184374185984, 549757911040, 274880004096, 68721573888, 34361835520, 17181966336, 8592031744, 4297064448, 538968064, 2305843009213702144, 9007199254749184, 35184372097024, 549755822080, 274877915136, 68719484928, 34359746560, 17179877376, 8589942784, 4294975488, 536879104, 2105344, 2305843009213693984, 9007199254741024, 35184372088864, 549755813920, 274877906976, 68719476768, 34359738400, 17179869216, 8589934624, 4294967328, 536870944, 2097184, 8224), (4629700416936869888, 4611756387171565568, 18084767253659648, 4611686568183201792, 18014948265295872, 70918499991552, 4611686155866341376, 18014535948435456, 70506183131136, 687194767360, 4611686087146864640, 18014467228958720, 70437463654400, 618475290624, 206158430208, 4611686052787126272, 18014432869220352, 70403103916032, 584115552256, 171798691840, 103079215104, 4611686035607257088, 18014415689351168, 70385924046848, 566935683072, 154618822656, 85899345920, 51539607552, 4611686027017322496, 18014407099416576, 70377334112256, 558345748480, 146028888064, 77309411328, 42949672960, 25769803776, 4611686022722355200, 18014402804449280, 70373039144960, 554050781184, 141733920768, 73014444032, 38654705664, 21474836480, 12884901888, 4611686019501129728, 18014399583223808, 70369817919488, 550829555712, 138512695296, 69793218560, 35433480192, 18253611008, 9663676416, 5368709120, 4611686018431582208, 18014398513676288, 70368748371968, 549760008192, 137443147776, 68723671040, 34363932672, 17184063488, 8594128896, 4299161600, 1077936128, 4611686018427404288, 18014398509498368, 70368744194048, 549755830272, 137438969856, 68719493120, 34359754752, 17179885568, 8589950976, 4294983680, 1073758208, 4210688, 4611686018427387968, 18014398509482048, 70368744177728, 549755813952, 137438953536, 68719476800, 34359738432, 17179869248, 8589934656, 4294967360, 1073741888, 4194368, 16448), (9259400833873739776, 9223512774343131136, 36169534507319296, 9223372311732682752, 36029071896870912, 141012366262272, 9223372174293729280, 36028934457917440, 140874927308800, 412316860416, 9223372105574252544, 36028865738440704, 140806207832064, 343597383680, 206158430208, 9223372071214514176, 36028831378702336, 140771848093696, 309237645312, 171798691840, 103079215104, 9223372054034644992, 36028814198833152, 140754668224512, 292057776128, 154618822656, 85899345920, 51539607552, 9223372045444710400, 36028805608898560, 140746078289920, 283467841536, 146028888064, 77309411328, 42949672960, 25769803776, 9223372041149743104, 36028801313931264, 140741783322624, 279172874240, 141733920768, 73014444032, 38654705664, 21474836480, 12884901888, 9223372039002259456, 36028799166447616, 140739635838976, 277025390592, 139586437120, 70866960384, 36507222016, 19327352832, 10737418240, 6442450944, 9223372036863164416, 36028797027352576, 140737496743936, 274886295552, 137447342080, 68727865344, 34368126976, 17188257792, 8598323200, 4303355904, 2155872256, 9223372036854808576, 36028797018996736, 140737488388096, 274877939712, 137438986240, 68719509504, 34359771136, 17179901952, 8589967360, 4295000064, 2147516416, 8421376, 9223372036854775936, 36028797018964096, 140737488355456, 274877907072, 137438953600, 68719476864, 34359738496, 17179869312, 8589934720, 4294967424, 2147483776, 8388736, 32896), (72339069014638592, 72198331526283264, 422212465065984, 72127962782105600, 351843720888320, 211106232532992, 72092778410016768, 316659348799488, 175921860444160, 105553116266496, 72075186223972352, 299067162755072, 158329674399744, 87960930222080, 52776558133248, 72066390130950144, 290271069732864, 149533581377536, 79164837199872, 43980465111040, 26388279066624, 72061992084439040, 285873023221760, 145135534866432, 74766790688768, 39582418599936, 21990232555520, 13194139533312, 72059793061183488, 283673999966208, 142936511610880, 72567767433216, 37383395344384, 19791209299968, 10995116277760, 6597069766656, 72057598332895232, 281479271677952, 140741783322624, 70373039144960, 35188667056128, 17596481011712, 8800387989504, 4402341478400, 2203318222848, 72057594054705152, 281474993487872, 140737505132544, 70368760954880, 35184388866048, 17592202821632, 8796109799424, 4398063288320, 2199040032768, 4311744512, 72057594037993472, 281474976776192, 140737488420864, 70368744243200, 35184372154368, 17592186109952, 8796093087744, 4398046576640, 2199023321088, 4295032832, 16842752, 72057594037928192, 281474976710912, 140737488355584, 70368744177920, 35184372089088, 17592186044672, 8796093022464, 4398046511360, 2199023255808, 4294967552, 16777472, 65792, 72057594037927937, 281474976710657, 140737488355329, 70368744177665, 35184372088833, 17592186044417, 8796093022209, 4398046511105, 2199023255553, 4294967297, 16777217, 65537, 257), (144678138029277184, 144255925564211200, 703687441776640, 144185556820033536, 633318697598976, 211106232532992, 144150372447944704, 598134325510144, 175921860444160, 105553116266496, 144132780261900288, 580542139465728, 158329674399744, 87960930222080, 52776558133248, 144123984168878080, 571746046443520, 149533581377536, 79164837199872, 43980465111040, 26388279066624, 144119586122366976, 567347999932416, 145135534866432, 74766790688768, 39582418599936, 21990232555520, 13194139533312, 144116287587483648, 564049465049088, 141836999983104, 71468255805440, 36283883716608, 18691697672192, 9895604649984, 5497558138880, 144115196665790464, 562958543355904, 140746078289920, 70377334112256, 35192962023424, 17600775979008, 8804682956800, 4406636445696, 1108101562368, 144115188109410304, 562949986975744, 140737521909760, 70368777732096, 35184405643264, 17592219598848, 8796126576640, 4398080065536, 1099545182208, 8623489024, 144115188075986944, 562949953552384, 140737488486400, 70368744308736, 35184372219904, 17592186175488, 8796093153280, 4398046642176, 1099511758848, 8590065664, 33685504, 144115188075856384, 562949953421824, 140737488355840, 70368744178176, 35184372089344, 17592186044928, 8796093022720, 4398046511616, 1099511628288, 8589935104, 33554944, 131584, 144115188075855874, 562949953421314, 140737488355330, 70368744177666, 35184372088834, 17592186044418, 8796093022210, 4398046511106, 1099511627778, 8589934594, 33554434, 131074, 514), (289356276058554368, 288371113640067072, 1266637395197952, 288300744895889408, 1196268651020288, 211106232532992, 288265560523800576, 1161084278931456, 175921860444160, 105553116266496, 288247968337756160, 1143492092887040, 158329674399744, 87960930222080, 52776558133248, 288239172244733952, 1134695999864832, 149533581377536, 79164837199872, 43980465111040, 26388279066624, 288232575174967296, 1128098930098176, 142936511610880, 72567767433216, 37383395344384, 19791209299968, 10995116277760, 288231475663339520, 1126999418470400, 141836999983104, 71468255805440, 36283883716608, 18691697672192, 9895604649984, 3298534883328, 288230393331580928, 1125917086711808, 140754668224512, 70385924046848, 35201551958016, 17609365913600, 8813272891392, 2216203124736, 1116691496960, 288230376218820608, 1125899973951488, 140737555464192, 70368811286528, 35184439197696, 17592253153280, 8796160131072, 2199090364416, 1099578736640, 17246978048, 288230376151973888, 1125899907104768, 140737488617472, 70368744439808, 35184372350976, 17592186306560, 8796093284352, 2199023517696, 1099511889920, 17180131328, 67371008, 288230376151712768, 1125899906843648, 140737488356352, 70368744178688, 35184372089856, 17592186045440, 8796093023232, 2199023256576, 1099511628800, 17179870208, 67109888, 263168, 288230376151711748, 1125899906842628, 140737488355332, 70368744177668, 35184372088836, 17592186044420, 8796093022212, 2199023255556, 1099511627780, 17179869188, 67108868, 262148, 1028), (578712552117108736, 576601489791778816, 2392537302040576, 576531121047601152, 2322168557862912, 211106232532992, 576495936675512320, 2286984185774080, 175921860444160, 105553116266496, 576478344489467904, 2269391999729664, 158329674399744, 87960930222080, 52776558133248, 576465150349934592, 2256197860196352, 145135534866432, 74766790688768, 39582418599936, 21990232555520, 576462951326679040, 2253998836940800, 142936511610880, 72567767433216, 37383395344384, 19791209299968, 6597069766656, 576461851815051264, 2252899325313024, 141836999983104, 71468255805440, 36283883716608, 18691697672192, 5497558138880, 3298534883328, 576460786663161856, 2251834173423616, 140771848093696, 70403103916032, 35218731827200, 17626545782784, 4432406249472, 2233382993920, 1133871366144, 576460752437641216, 2251799947902976, 140737622573056, 70368878395392, 35184506306560, 17592320262144, 4398180728832, 2199157473280, 1099645845504, 34493956096, 576460752303947776, 2251799814209536, 140737488879616, 70368744701952, 35184372613120, 17592186568704, 4398047035392, 2199023779840, 1099512152064, 34360262656, 134742016, 576460752303425536, 2251799813687296, 140737488357376, 70368744179712, 35184372090880, 17592186046464, 4398046513152, 2199023257600, 1099511629824, 34359740416, 134219776, 526336, 576460752303423496, 2251799813685256, 140737488355336, 70368744177672, 35184372088840, 17592186044424, 4398046511112, 2199023255560, 1099511627784, 34359738376, 134217736, 524296, 2056), (1157425104234217472, 1153062242095202304, 4644337115725824, 1152991873351024640, 4573968371548160, 211106232532992, 1152956688978935808, 4538783999459328, 175921860444160, 105553116266496, 1152930300699869184, 4512395720392704, 149533581377536, 79164837199872, 43980465111040, 1152925902653358080, 4507997673881600, 145135534866432, 74766790688768, 39582418599936, 13194139533312, 1152923703630102528, 4505798650626048, 142936511610880, 72567767433216, 37383395344384, 10995116277760, 6597069766656, 1152922604118474752, 4504699138998272, 141836999983104, 71468255805440, 36283883716608, 9895604649984, 5497558138880, 3298534883328, 1152921573326323712, 4503668346847232, 140806207832064, 70437463654400, 35253091565568, 8864812498944, 4466765987840, 2267742732288, 1168231104512, 1152921504875282432, 4503599895805952, 140737756790784, 70369012613120, 35184640524288, 8796361457664, 4398314946560, 2199291691008, 1099780063232, 68987912192, 1152921504607895552, 4503599628419072, 140737489403904, 70368745226240, 35184373137408, 8796094070784, 4398047559680, 2199024304128, 1099512676352, 68720525312, 269484032, 1152921504606851072, 4503599627374592, 140737488359424, 70368744181760, 35184372092928, 8796093026304, 4398046515200, 2199023259648, 1099511631872, 68719480832, 268439552, 1052672, 1152921504606846992, 4503599627370512, 140737488355344, 70368744177680, 35184372088848, 8796093022224, 4398046511120, 2199023255568, 1099511627792, 68719476752, 268435472, 1048592, 4112), (2314850208468434944, 2305983746702049280, 9147936743096320, 2305913377957871616, 9077567998918656, 211106232532992, 2305860601399738368, 9024791440785408, 158329674399744, 87960930222080, 2305851805306716160, 9015995347763200, 149533581377536, 79164837199872, 26388279066624, 2305847407260205056, 9011597301252096, 145135534866432, 74766790688768, 21990232555520, 13194139533312, 2305845208236949504, 9009398277996544, 142936511610880, 72567767433216, 19791209299968, 10995116277760, 6597069766656, 2305844108725321728, 9008298766368768, 141836999983104, 71468255805440, 18691697672192, 9895604649984, 5497558138880, 3298534883328, 2305843146652647424, 9007336693694464, 140874927308800, 70506183131136, 17729624997888, 8933531975680, 4535485464576, 2336462209024, 1236950581248, 2305843009750564864, 9007199791611904, 140738025226240, 70369281048576, 17592722915328, 8796629893120, 4398583382016, 2199560126464, 1100048498688, 137975824384, 2305843009215791104, 9007199256838144, 140737490452480, 70368746274816, 17592188141568, 8796095119360, 4398048608256, 2199025352704, 1099513724928, 137441050624, 538968064, 2305843009213702144, 9007199254749184, 140737488363520, 70368744185856, 17592186052608, 8796093030400, 4398046519296, 2199023263744, 1099511635968, 137438961664, 536879104, 2105344, 2305843009213693984, 9007199254741024, 140737488355360, 70368744177696, 17592186044448, 8796093022240, 4398046511136, 2199023255584, 1099511627808, 137438953504, 536870944, 2097184, 8224), (4629700416936869888, 4611826755915743232, 18155135997837312, 4611721202799476736, 18049582881570816, 175921860444160, 4611703610613432320, 18031990695526400, 158329674399744, 52776558133248, 4611694814520410112, 18023194602504192, 149533581377536, 43980465111040, 26388279066624, 4611690416473899008, 18018796555993088, 145135534866432, 39582418599936, 21990232555520, 13194139533312, 4611688217450643456, 18016597532737536, 142936511610880, 37383395344384, 19791209299968, 10995116277760, 6597069766656, 4611687117939015680, 18015498021109760, 141836999983104, 36283883716608, 18691697672192, 9895604649984, 5497558138880, 3298534883328, 4611686293305294848, 18014673387388928, 141012366262272, 35459249995776, 17867063951360, 9070970929152, 4672924418048, 2473901162496, 1374389534720, 4611686019501129728, 18014399583223808, 140738562097152, 35185445830656, 17593259786240, 8797166764032, 4399120252928, 2200096997376, 1100585369600, 275951648768, 4611686018431582208, 18014398513676288, 140737492549632, 35184376283136, 17592190238720, 8796097216512, 4398050705408, 2199027449856, 1099515822080, 274882101248, 1077936128, 4611686018427404288, 18014398509498368, 140737488371712, 35184372105216, 17592186060800, 8796093038592, 4398046527488, 2199023271936, 1099511644160, 274877923328, 1073758208, 4210688, 4611686018427387968, 18014398509482048, 140737488355392, 35184372088896, 17592186044480, 8796093022272, 4398046511168, 2199023255616, 1099511627840, 274877907008, 1073741888, 4194368, 16448), (9259400833873739776, 9223442405598953472, 36099165763141632, 9223407221226864640, 36063981391052800, 105553116266496, 9223389629040820224, 36046389205008384, 87960930222080, 52776558133248, 9223380832947798016, 36037593111986176, 79164837199872, 43980465111040, 26388279066624, 9223376434901286912, 36033195065475072, 74766790688768, 39582418599936, 21990232555520, 13194139533312, 9223374235878031360, 36030996042219520, 72567767433216, 37383395344384, 19791209299968, 10995116277760, 6597069766656, 9223373136366403584, 36029896530591744, 71468255805440, 36283883716608, 18691697672192, 9895604649984, 5497558138880, 3298534883328, 9223372586610589696, 36029346774777856, 70918499991552, 35734127902720, 18141941858304, 9345848836096, 4947802324992, 2748779069440, 1649267441664, 9223372039002259456, 36028799166447616, 70370891661312, 35186519572480, 17594333528064, 8798240505856, 4400193994752, 2201170739200, 1101659111424, 551903297536, 9223372036863164416, 36028797027352576, 70368752566272, 35184380477440, 17592194433024, 8796101410816, 4398054899712, 2199031644160, 1099520016384, 549764202496, 2155872256, 9223372036854808576, 36028797018996736, 70368744210432, 35184372121600, 17592186077184, 8796093054976, 4398046543872, 2199023288320, 1099511660544, 549755846656, 2147516416, 8421376, 9223372036854775936, 36028797018964096, 70368744177792, 35184372088960, 17592186044544, 8796093022336, 4398046511232, 2199023255680, 1099511627904, 549755814016, 2147483776, 8388736, 32896), (108086391056891904, 90071992547409920, 54043195528445952, 81064793292668928, 45035996273704960, 27021597764222976, 76561193665298432, 40532396646334464, 22517998136852480, 13510798882111488, 74309393851613184, 38280596832649216, 20266198323167232, 11258999068426240, 6755399441055744, 73183493944770560, 37154696925806592, 19140298416324608, 10133099161583616, 5629499534213120, 3377699720527872, 72620543991349248, 36591746972385280, 18577348462903296, 9570149208162304, 5066549580791808, 2814749767106560, 1688849860263936, 72058693549555712, 36029896530591744, 18015498021109760, 9008298766368768, 4504699138998272, 2252899325313024, 1126999418470400, 564049465049088, 72057598332895232, 36028801313931264, 18014402804449280, 9007203549708288, 4503603922337792, 2251804108652544, 1125904201809920, 562954248388608, 1103806595072, 72057594054705152, 36028797035741184, 18014398526259200, 9007199271518208, 4503599644147712, 2251799830462464, 1125899923619840, 562949970198528, 1099528404992, 4311744512, 72057594037993472, 36028797019029504, 18014398509547520, 9007199254806528, 4503599627436032, 2251799813750784, 1125899906908160, 562949953486848, 1099511693312, 4295032832, 16842752, 72057594037928192, 36028797018964224, 18014398509482240, 9007199254741248, 4503599627370752, 2251799813685504, 1125899906842880, 562949953421568, 1099511628032, 4294967552, 16777472, 65792, 72057594037927937, 36028797018963969, 18014398509481985, 9007199254740993, 4503599627370497, 2251799813685249, 1125899906842625, 562949953421313, 1099511627777, 4294967297, 16777217, 65537, 257), (180143985094819840, 162129586585337856, 54043195528445952, 153122387330596864, 45035996273704960, 27021597764222976, 148618787703226368, 40532396646334464, 22517998136852480, 13510798882111488, 146366987889541120, 38280596832649216, 20266198323167232, 11258999068426240, 6755399441055744, 145241087982698496, 37154696925806592, 19140298416324608, 10133099161583616, 5629499534213120, 3377699720527872, 144396663052566528, 36310271995674624, 18295873486192640, 9288674231451648, 4785074604081152, 2533274790395904, 1407374883553280, 144117387099111424, 36030996042219520, 18016597532737536, 9009398277996544, 4505798650626048, 2253998836940800, 1128098930098176, 283673999966208, 144115196665790464, 36028805608898560, 18014407099416576, 9007207844675584, 4503608217305088, 2251808403619840, 1125908496777216, 281483566645248, 2207613190144, 144115188109410304, 36028797052518400, 18014398543036416, 9007199288295424, 4503599660924928, 2251799847239680, 1125899940397056, 281475010265088, 2199056809984, 8623489024, 144115188075986944, 36028797019095040, 18014398509613056, 9007199254872064, 4503599627501568, 2251799813816320, 1125899906973696, 281474976841728, 2199023386624, 8590065664, 33685504, 144115188075856384, 36028797018964480, 18014398509482496, 9007199254741504, 4503599627371008, 2251799813685760, 1125899906843136, 281474976711168, 2199023256064, 8589935104, 33554944, 131584, 144115188075855874, 36028797018963970, 18014398509481986, 9007199254740994, 4503599627370498, 2251799813685250, 1125899906842626, 281474976710658, 2199023255554, 8589934594, 33554434, 131074, 514), (324259173170675712, 306244774661193728, 54043195528445952, 297237575406452736, 45035996273704960, 27021597764222976, 292733975779082240, 40532396646334464, 22517998136852480, 13510798882111488, 290482175965396992, 38280596832649216, 20266198323167232, 11258999068426240, 6755399441055744, 288793326105133056, 36591746972385280, 18577348462903296, 9570149208162304, 5066549580791808, 2814749767106560, 288511851128422400, 36310271995674624, 18295873486192640, 9288674231451648, 4785074604081152, 2533274790395904, 844424930131968, 288234774198222848, 36033195065475072, 18018796555993088, 9011597301252096, 4507997673881600, 2256197860196352, 567347999932416, 285873023221760, 288230393331580928, 36028814198833152, 18014415689351168, 9007216434610176, 4503616807239680, 2251816993554432, 562967133290496, 281492156579840, 4415226380288, 288230376218820608, 36028797086072832, 18014398576590848, 9007199321849856, 4503599694479360, 2251799880794112, 562950020530176, 281475043819520, 4398113619968, 17246978048, 288230376151973888, 36028797019226112, 18014398509744128, 9007199255003136, 4503599627632640, 2251799813947392, 562949953683456, 281474976972800, 4398046773248, 17180131328, 67371008, 288230376151712768, 36028797018964992, 18014398509483008, 9007199254742016, 4503599627371520, 2251799813686272, 562949953422336, 281474976711680, 4398046512128, 17179870208, 67109888, 263168, 288230376151711748, 36028797018963972, 18014398509481988, 9007199254740996, 4503599627370500, 2251799813685252, 562949953421316, 281474976710660, 4398046511108, 17179869188, 67108868, 262148, 1028), (612489549322387456, 594475150812905472, 54043195528445952, 585467951558164480, 45035996273704960, 27021597764222976, 580964351930793984, 40532396646334464, 22517998136852480, 13510798882111488, 577586652210266112, 37154696925806592, 19140298416324608, 10133099161583616, 5629499534213120, 577023702256844800, 36591746972385280, 18577348462903296, 9570149208162304, 5066549580791808, 1688849860263936, 576742227280134144, 36310271995674624, 18295873486192640, 9288674231451648, 4785074604081152, 1407374883553280, 844424930131968, 576469548396445696, 36037593111986176, 18023194602504192, 9015995347763200, 4512395720392704, 1134695999864832, 571746046443520, 290271069732864, 576460786663161856, 36028831378702336, 18014432869220352, 9007233614479360, 4503633987108864, 1125934266580992, 562984313159680, 281509336449024, 8830452760576, 576460752437641216, 36028797153181696, 18014398643699712, 9007199388958720, 4503599761588224, 1125900041060352, 562950087639040, 281475110928384, 8796227239936, 34493956096, 576460752303947776, 36028797019488256, 18014398510006272, 9007199255265280, 4503599627894784, 1125899907366912, 562949953945600, 281474977234944, 8796093546496, 34360262656, 134742016, 576460752303425536, 36028797018966016, 18014398509484032, 9007199254743040, 4503599627372544, 1125899906844672, 562949953423360, 281474976712704, 8796093024256, 34359740416, 134219776, 526336, 576460752303423496, 36028797018963976, 18014398509481992, 9007199254741000, 4503599627370504, 1125899906842632, 562949953421320, 281474976710664, 8796093022216, 34359738376, 134217736, 524296, 2056), (1188950301625810944, 1170935903116328960, 54043195528445952, 1161928703861587968, 45035996273704960, 27021597764222976, 1155173304420532224, 38280596832649216, 20266198323167232, 11258999068426240, 1154047404513689600, 37154696925806592, 19140298416324608, 10133099161583616, 3377699720527872, 1153484454560268288, 36591746972385280, 18577348462903296, 9570149208162304, 2814749767106560, 1688849860263936, 1153202979583557632, 36310271995674624, 18295873486192640, 9288674231451648, 2533274790395904, 1407374883553280, 844424930131968, 1152939096792891392, 36046389205008384, 18031990695526400, 9024791440785408, 2269391999729664, 1143492092887040, 580542139465728, 299067162755072, 1152921573326323712, 36028865738440704, 18014467228958720, 9007267974217728, 2251868533161984, 1125968626319360, 563018672898048, 281543696187392, 17660905521152, 1152921504875282432, 36028797287399424, 18014398777917440, 9007199523176448, 2251800082120704, 1125900175278080, 562950221856768, 281475245146112, 17592454479872, 68987912192, 1152921504607895552, 36028797020012544, 18014398510530560, 9007199255789568, 2251799814733824, 1125899907891200, 562949954469888, 281474977759232, 17592187092992, 68720525312, 269484032, 1152921504606851072, 36028797018968064, 18014398509486080, 9007199254745088, 2251799813689344, 1125899906846720, 562949953425408, 281474976714752, 17592186048512, 68719480832, 268439552, 1052672, 1152921504606846992, 36028797018963984, 18014398509482000, 9007199254741008, 2251799813685264, 1125899906842640, 562949953421328, 281474976710672, 17592186044432, 68719476752, 268435472, 1048592, 4112), (2341871806232657920, 2323857407723175936, 54043195528445952, 2310346608841064448, 40532396646334464, 22517998136852480, 2308094809027379200, 38280596832649216, 20266198323167232, 6755399441055744, 2306968909120536576, 37154696925806592, 19140298416324608, 5629499534213120, 3377699720527872, 2306405959167115264, 36591746972385280, 18577348462903296, 5066549580791808, 2814749767106560, 1688849860263936, 2306124484190404608, 36310271995674624, 18295873486192640, 4785074604081152, 2533274790395904, 1407374883553280, 844424930131968, 2305878193585782784, 36063981391052800, 18049582881570816, 4538783999459328, 2286984185774080, 1161084278931456, 598134325510144, 316659348799488, 2305843146652647424, 36028934457917440, 18014535948435456, 4503737066323968, 2251937252638720, 1126037345796096, 563087392374784, 281612415664128, 35321811042304, 2305843009750564864, 36028797555834880, 18014399046352896, 4503600164241408, 2251800350556160, 1125900443713536, 562950490292224, 281475513581568, 35184908959744, 137975824384, 2305843009215791104, 36028797021061120, 18014398511579136, 4503599629467648, 2251799815782400, 1125899908939776, 562949955518464, 281474978807808, 35184374185984, 137441050624, 538968064, 2305843009213702144, 36028797018972160, 18014398509490176, 4503599627378688, 2251799813693440, 1125899906850816, 562949953429504, 281474976718848, 35184372097024, 137438961664, 536879104, 2105344, 2305843009213693984, 36028797018964000, 18014398509482016, 4503599627370528, 2251799813685280, 1125899906842656, 562949953421344, 281474976710688, 35184372088864, 137438953504, 536870944, 2097184, 8224), (4647714815446351872, 4620693217682128896, 45035996273704960, 4616189618054758400, 40532396646334464, 13510798882111488, 4613937818241073152, 38280596832649216, 11258999068426240, 6755399441055744, 4612811918334230528, 37154696925806592, 10133099161583616, 5629499534213120, 3377699720527872, 4612248968380809216, 36591746972385280, 9570149208162304, 5066549580791808, 2814749767106560, 1688849860263936, 4611967493404098560, 36310271995674624, 9288674231451648, 4785074604081152, 2533274790395904, 1407374883553280, 844424930131968, 4611756387171565568, 36099165763141632, 9077567998918656, 4573968371548160, 2322168557862912, 1196268651020288, 633318697598976, 351843720888320, 4611686293305294848, 36029071896870912, 9007474132647936, 4503874505277440, 2252074691592192, 1126174784749568, 563224831328256, 281749854617600, 70643622084608, 4611686019501129728, 36028798092705792, 9007200328482816, 4503600701112320, 2251800887427072, 1125900980584448, 562951027163136, 281476050452480, 70369817919488, 275951648768, 4611686018431582208, 36028797023158272, 9007199258935296, 4503599631564800, 2251799817879552, 1125899911036928, 562949957615616, 281474980904960, 70368748371968, 274882101248, 1077936128, 4611686018427404288, 36028797018980352, 9007199254757376, 4503599627386880, 2251799813701632, 1125899906859008, 562949953437696, 281474976727040, 70368744194048, 274877923328, 1073758208, 4210688, 4611686018427387968, 36028797018964032, 9007199254741056, 4503599627370560, 2251799813685312, 1125899906842688, 562949953421376, 281474976710720, 70368744177728, 274877907008, 1073741888, 4194368, 16448), (9241386435364257792, 9232379236109516800, 27021597764222976, 9227875636482146304, 22517998136852480, 13510798882111488, 9225623836668461056, 20266198323167232, 11258999068426240, 6755399441055744, 9224497936761618432, 19140298416324608, 10133099161583616, 5629499534213120, 3377699720527872, 9223934986808197120, 18577348462903296, 9570149208162304, 5066549580791808, 2814749767106560, 1688849860263936, 9223653511831486464, 18295873486192640, 9288674231451648, 4785074604081152, 2533274790395904, 1407374883553280, 844424930131968, 9223512774343131136, 18155135997837312, 9147936743096320, 4644337115725824, 2392537302040576, 1266637395197952, 703687441776640, 422212465065984, 9223372586610589696, 18014948265295872, 9007749010554880, 4504149383184384, 2252349569499136, 1126449662656512, 563499709235200, 282024732524544, 141287244169216, 9223372039002259456, 18014400656965632, 9007201402224640, 4503601774854144, 2251801961168896, 1125902054326272, 562952100904960, 281477124194304, 140739635838976, 551903297536, 9223372036863164416, 18014398517870592, 9007199263129600, 4503599635759104, 2251799822073856, 1125899915231232, 562949961809920, 281474985099264, 140737496743936, 549764202496, 2155872256, 9223372036854808576, 18014398509514752, 9007199254773760, 4503599627403264, 2251799813718016, 1125899906875392, 562949953454080, 281474976743424, 140737488388096, 549755846656, 2147516416, 8421376, 9223372036854775936, 18014398509482112, 9007199254741120, 4503599627370624, 2251799813685376, 1125899906842752, 562949953421440, 281474976710784, 140737488355456, 549755814016, 2147483776, 8388736, 32896), (13835058055282163712, 11529215046068469760, 6917529027641081856, 10376293541461622784, 5764607523034234880, 3458764513820540928, 9799832789158199296, 5188146770730811392, 2882303761517117440, 1729382256910270464, 9511602413006487552, 4899916394579099648, 2594073385365405696, 1441151880758558720, 864691128455135232, 9367487224930631680, 4755801206503243776, 2449958197289549824, 1297036692682702848, 720575940379279360, 432345564227567616, 9223653511831486464, 4611967493404098560, 2306124484190404608, 1153202979583557632, 576742227280134144, 288511851128422400, 144396663052566528, 9223373136366403584, 4611687117939015680, 2305844108725321728, 1152922604118474752, 576461851815051264, 288231475663339520, 144116287587483648, 282574488338432, 9223372041149743104, 4611686022722355200, 2305843013508661248, 1152921508901814272, 576460756598390784, 288230380446679040, 144115192370823168, 281479271677952, 1103806595072, 9223372036871553024, 4611686018444165120, 2305843009230471168, 1152921504623624192, 576460752320200704, 288230376168488960, 144115188092633088, 281474993487872, 1099528404992, 4311744512, 9223372036854841344, 4611686018427453440, 2305843009213759488, 1152921504606912512, 576460752303489024, 288230376151777280, 144115188075921408, 281474976776192, 1099511693312, 4295032832, 16842752, 9223372036854776064, 4611686018427388160, 2305843009213694208, 1152921504606847232, 576460752303423744, 288230376151712000, 144115188075856128, 281474976710912, 1099511628032, 4294967552, 16777472, 65792, 9223372036854775809, 4611686018427387905, 2305843009213693953, 1152921504606846977, 576460752303423489, 288230376151711745, 144115188075855873, 281474976710657, 1099511627777, 4294967297, 16777217, 65537, 257), (13835058055282163712, 11529215046068469760, 6917529027641081856, 10376293541461622784, 5764607523034234880, 3458764513820540928, 9799832789158199296, 5188146770730811392, 2882303761517117440, 1729382256910270464, 9511602413006487552, 4899916394579099648, 2594073385365405696, 1441151880758558720, 864691128455135232, 9295429630892703744, 4683743612465315840, 2377900603251621888, 1224979098644774912, 648518346341351424, 360287970189639680, 9223934986808197120, 4612248968380809216, 2306405959167115264, 1153484454560268288, 577023702256844800, 288793326105133056, 72620543991349248, 9223374235878031360, 4611688217450643456, 2305845208236949504, 1152923703630102528, 576462951326679040, 288232575174967296, 72059793061183488, 565148976676864, 9223372045444710400, 4611686027017322496, 2305843017803628544, 1152921513196781568, 576460760893358080, 288230384741646336, 72057602627862528, 562958543355904, 2207613190144, 9223372036888330240, 4611686018460942336, 2305843009247248384, 1152921504640401408, 576460752336977920, 288230376185266176, 72057594071482368, 562949986975744, 2199056809984, 8623489024, 9223372036854906880, 4611686018427518976, 2305843009213825024, 1152921504606978048, 576460752303554560, 288230376151842816, 72057594038059008, 562949953552384, 2199023386624, 8590065664, 33685504, 9223372036854776320, 4611686018427388416, 2305843009213694464, 1152921504606847488, 576460752303424000, 288230376151712256, 72057594037928448, 562949953421824, 2199023256064, 8589935104, 33554944, 131584, 9223372036854775810, 4611686018427387906, 2305843009213693954, 1152921504606846978, 576460752303423490, 288230376151711746, 72057594037927938, 562949953421314, 2199023255554, 8589934594, 33554434, 131074, 514), (13835058055282163712, 11529215046068469760, 6917529027641081856, 10376293541461622784, 5764607523034234880, 3458764513820540928, 9799832789158199296, 5188146770730811392, 2882303761517117440, 1729382256910270464, 9367487224930631680, 4755801206503243776, 2449958197289549824, 1297036692682702848, 720575940379279360, 9295429630892703744, 4683743612465315840, 2377900603251621888, 1224979098644774912, 648518346341351424, 216172782113783808, 9224497936761618432, 4612811918334230528, 2306968909120536576, 1154047404513689600, 577586652210266112, 145241087982698496, 73183493944770560, 9223376434901286912, 4611690416473899008, 2305847407260205056, 1152925902653358080, 576465150349934592, 144119586122366976, 72061992084439040, 1130297953353728, 9223372054034644992, 4611686035607257088, 2305843026393563136, 1152921521786716160, 576460769483292672, 144115205255725056, 72057611217797120, 1125917086711808, 4415226380288, 9223372036921884672, 4611686018494496768, 2305843009280802816, 1152921504673955840, 576460752370532352, 144115188142964736, 72057594105036800, 1125899973951488, 4398113619968, 17246978048, 9223372036855037952, 4611686018427650048, 2305843009213956096, 1152921504607109120, 576460752303685632, 144115188076118016, 72057594038190080, 1125899907104768, 4398046773248, 17180131328, 67371008, 9223372036854776832, 4611686018427388928, 2305843009213694976, 1152921504606848000, 576460752303424512, 144115188075856896, 72057594037928960, 1125899906843648, 4398046512128, 17179870208, 67109888, 263168, 9223372036854775812, 4611686018427387908, 2305843009213693956, 1152921504606846980, 576460752303423492, 144115188075855876, 72057594037927940, 1125899906842628, 4398046511108, 17179869188, 67108868, 262148, 1028), (13835058055282163712, 11529215046068469760, 6917529027641081856, 10376293541461622784, 5764607523034234880, 3458764513820540928, 9511602413006487552, 4899916394579099648, 2594073385365405696, 1441151880758558720, 9367487224930631680, 4755801206503243776, 2449958197289549824, 1297036692682702848, 432345564227567616, 9295429630892703744, 4683743612465315840, 2377900603251621888, 1224979098644774912, 360287970189639680, 216172782113783808, 9225623836668461056, 4613937818241073152, 2308094809027379200, 1155173304420532224, 290482175965396992, 146366987889541120, 74309393851613184, 9223380832947798016, 4611694814520410112, 2305851805306716160, 1152930300699869184, 288239172244733952, 144123984168878080, 72066390130950144, 2260595906707456, 9223372071214514176, 4611686052787126272, 2305843043573432320, 1152921538966585344, 288230410511450112, 144115222435594240, 72057628397666304, 2251834173423616, 8830452760576, 9223372036988993536, 4611686018561605632, 2305843009347911680, 1152921504741064704, 288230376285929472, 144115188210073600, 72057594172145664, 2251799947902976, 8796227239936, 34493956096, 9223372036855300096, 4611686018427912192, 2305843009214218240, 1152921504607371264, 288230376152236032, 144115188076380160, 72057594038452224, 2251799814209536, 8796093546496, 34360262656, 134742016, 9223372036854777856, 4611686018427389952, 2305843009213696000, 1152921504606849024, 288230376151713792, 144115188075857920, 72057594037929984, 2251799813687296, 8796093024256, 34359740416, 134219776, 526336, 9223372036854775816, 4611686018427387912, 2305843009213693960, 1152921504606846984, 288230376151711752, 144115188075855880, 72057594037927944, 2251799813685256, 8796093022216, 34359738376, 134217736, 524296, 2056), (13835058055282163712, 11529215046068469760, 6917529027641081856, 9799832789158199296, 5188146770730811392, 2882303761517117440, 9511602413006487552, 4899916394579099648, 2594073385365405696, 864691128455135232, 9367487224930631680, 4755801206503243776, 2449958197289549824, 720575940379279360, 432345564227567616, 9295429630892703744, 4683743612465315840, 2377900603251621888, 648518346341351424, 360287970189639680, 216172782113783808, 9227875636482146304, 4616189618054758400, 2310346608841064448, 580964351930793984, 292733975779082240, 148618787703226368, 76561193665298432, 9223389629040820224, 4611703610613432320, 2305860601399738368, 576478344489467904, 288247968337756160, 144132780261900288, 72075186223972352, 4521191813414912, 9223372105574252544, 4611686087146864640, 2305843077933170688, 576460821022900224, 288230444871188480, 144115256795332608, 72057662757404672, 4503668346847232, 17660905521152, 9223372037123211264, 4611686018695823360, 2305843009482129408, 576460752571858944, 288230376420147200, 144115188344291328, 72057594306363392, 4503599895805952, 17592454479872, 68987912192, 9223372036855824384, 4611686018428436480, 2305843009214742528, 576460752304472064, 288230376152760320, 144115188076904448, 72057594038976512, 4503599628419072, 17592187092992, 68720525312, 269484032, 9223372036854779904, 4611686018427392000, 2305843009213698048, 576460752303427584, 288230376151715840, 144115188075859968, 72057594037932032, 4503599627374592, 17592186048512, 68719480832, 268439552, 1052672, 9223372036854775824, 4611686018427387920, 2305843009213693968, 576460752303423504, 288230376151711760, 144115188075855888, 72057594037927952, 4503599627370512, 17592186044432, 68719476752, 268435472, 1048592, 4112), (13835058055282163712, 10376293541461622784, 5764607523034234880, 9799832789158199296, 5188146770730811392, 1729382256910270464, 9511602413006487552, 4899916394579099648, 1441151880758558720, 864691128455135232, 9367487224930631680, 4755801206503243776, 1297036692682702848, 720575940379279360, 432345564227567616, 9295429630892703744, 4683743612465315840, 1224979098644774912, 648518346341351424, 360287970189639680, 216172782113783808, 9232379236109516800, 4620693217682128896, 1161928703861587968, 585467951558164480, 297237575406452736, 153122387330596864, 81064793292668928, 9223407221226864640, 4611721202799476736, 1152956688978935808, 576495936675512320, 288265560523800576, 144150372447944704, 72092778410016768, 9042383626829824, 9223372174293729280, 4611686155866341376, 1152921642045800448, 576460889742376960, 288230513590665216, 144115325514809344, 72057731476881408, 9007336693694464, 35321811042304, 9223372037391646720, 4611686018964258816, 1152921505143717888, 576460752840294400, 288230376688582656, 144115188612726784, 72057594574798848, 9007199791611904, 35184908959744, 137975824384, 9223372036856872960, 4611686018429485056, 1152921504608944128, 576460752305520640, 288230376153808896, 144115188077953024, 72057594040025088, 9007199256838144, 35184374185984, 137441050624, 538968064, 9223372036854784000, 4611686018427396096, 1152921504606855168, 576460752303431680, 288230376151719936, 144115188075864064, 72057594037936128, 9007199254749184, 35184372097024, 137438961664, 536879104, 2105344, 9223372036854775840, 4611686018427387936, 1152921504606847008, 576460752303423520, 288230376151711776, 144115188075855904, 72057594037927968, 9007199254741024, 35184372088864, 137438953504, 536870944, 2097184, 8224), (11529215046068469760, 10376293541461622784, 3458764513820540928, 9799832789158199296, 2882303761517117440, 1729382256910270464, 9511602413006487552, 2594073385365405696, 1441151880758558720, 864691128455135232, 9367487224930631680, 2449958197289549824, 1297036692682702848, 720575940379279360, 432345564227567616, 9295429630892703744, 2377900603251621888, 1224979098644774912, 648518346341351424, 360287970189639680, 216172782113783808, 9241386435364257792, 2323857407723175936, 1170935903116328960, 594475150812905472, 306244774661193728, 162129586585337856, 90071992547409920, 9223442405598953472, 2305913377957871616, 1152991873351024640, 576531121047601152, 288300744895889408, 144185556820033536, 72127962782105600, 18084767253659648, 9223372311732682752, 2305843284091600896, 1152921779484753920, 576461027181330432, 288230651029618688, 144115462953762816, 72057868915834880, 18014673387388928, 70643622084608, 9223372037928517632, 2305843010287435776, 1152921505680588800, 576460753377165312, 288230377225453568, 144115189149597696, 72057595111669760, 18014399583223808, 70369817919488, 275951648768, 9223372036858970112, 2305843009217888256, 1152921504611041280, 576460752307617792, 288230376155906048, 144115188080050176, 72057594042122240, 18014398513676288, 70368748371968, 274882101248, 1077936128, 9223372036854792192, 2305843009213710336, 1152921504606863360, 576460752303439872, 288230376151728128, 144115188075872256, 72057594037944320, 18014398509498368, 70368744194048, 274877923328, 1073758208, 4210688, 9223372036854775872, 2305843009213694016, 1152921504606847040, 576460752303423552, 288230376151711808, 144115188075855936, 72057594037928000, 18014398509482048, 70368744177728, 274877907008, 1073741888, 4194368, 16448), (6917529027641081856, 5764607523034234880, 3458764513820540928, 5188146770730811392, 2882303761517117440, 1729382256910270464, 4899916394579099648, 2594073385365405696, 1441151880758558720, 864691128455135232, 4755801206503243776, 2449958197289549824, 1297036692682702848, 720575940379279360, 432345564227567616, 4683743612465315840, 2377900603251621888, 1224979098644774912, 648518346341351424, 360287970189639680, 216172782113783808, 4647714815446351872, 2341871806232657920, 1188950301625810944, 612489549322387456, 324259173170675712, 180143985094819840, 108086391056891904, 4611826755915743232, 2305983746702049280, 1153062242095202304, 576601489791778816, 288371113640067072, 144255925564211200, 72198331526283264, 36169534507319296, 4611686568183201792, 2305843558969507840, 1152922054362660864, 576461302059237376, 288230925907525632, 144115737831669760, 72058143793741824, 36029346774777856, 141287244169216, 4611686020574871552, 2305843011361177600, 1152921506754330624, 576460754450907136, 288230378299195392, 144115190223339520, 72057596185411584, 36028799166447616, 140739635838976, 551903297536, 4611686018435776512, 2305843009222082560, 1152921504615235584, 576460752311812096, 288230376160100352, 144115188084244480, 72057594046316544, 36028797027352576, 140737496743936, 549764202496, 2155872256, 4611686018427420672, 2305843009213726720, 1152921504606879744, 576460752303456256, 288230376151744512, 144115188075888640, 72057594037960704, 36028797018996736, 140737488388096, 549755846656, 2147516416, 8421376, 4611686018427388032, 2305843009213694080, 1152921504606847104, 576460752303423616, 288230376151711872, 144115188075856000, 72057594037928064, 36028797018964096, 140737488355456, 549755814016, 2147483776, 8388736, 32896))
# Combining into a tuple of tuples
precomputed_move_tables = (white_pawn_moves, knight_moves, bishop_full_rays, rook_full_rays, queen_full_rays, king_moves, white_pawn_attacks, black_pawn_attacks, black_pawn_moves)
slider_unfull_rays = (bishop_unfull_rays, rook_unfull_rays, queen_unfull_rays)


# Precomputed bishop and rook moves without magic numbers
from utils import generate_bit_combinations, get_valid_piece_moves_including_captures

long_precomputed_rook_table = []
for square in range(64):
    long_precomputed_rook_table.append({})
    blockers_bits = generate_bit_combinations(square, 'R')
    for blockers_bit in blockers_bits:
        valid_moves_bit = get_valid_piece_moves_including_captures(square, 'R', blockers_bit)
        long_precomputed_rook_table[square][blockers_bit] = valid_moves_bit


long_precomputed_bishop_table = []
for square in range(64):
    long_precomputed_bishop_table.append({})
    blockers_bits = generate_bit_combinations(square, 'B')
    for blockers_bit in blockers_bits:
        valid_moves_bit = get_valid_piece_moves_including_captures(square, 'B', blockers_bit)
        long_precomputed_bishop_table[square][blockers_bit] = valid_moves_bit



######################
# Position class
######################

'''

ENGINE IDEAS:

- Tests:
Create a test for the engine where it may play against older versions of itself 1000 times. To
see improvements.

- New Transposition Tables: 
For transposition tables I am going to use Zobrist Hashing, which is a method of hasshing poitions as 
a bit integer. It performs much faster than hashing with the fen strings. However some positions may not 
be distinguished from other different positions, but these are too small a number.

- Add Late move reductions:
This reduces the depth of moves which are ordered last in the ordered_moves. Read more about it.

- Improve Iterative deepening:
hmmm...

- Keep alpha Beta
- Keep Killer moves
- Keep Quiescence search
'''

from collections import namedtuple
from utils import get_set_bit_indices, find_least_significant_bit_set
Move = namedtuple("Move", "i j prom is_check")  # So to define a move we must do Move(square, destination_square, promotion(maybe use array index), move_score)
            
             
            
class BitPosition:
    def __init__(self, bitboard, psquare, wc, bc, turn, in_check, unsafe_squares):
        self.bitboard = bitboard  # list of 64-bit integers: w_pawns, w_knights, w_bishops, w_rooks, w_queens, w_king, ...
        self.psquare = psquare  # An integer representing the square that can be captured using en passant.
        # It will be -1 if the last move wasn't a double pawn move.
        # I will change the passant variable every time a double pawn move is made in
        # the move method.
        self.wc = wc
        self.bc = bc  # The castling rights, these will be lists of two Boolean variables. The first element
        # of the list represents kingside castle, the second queenside castle. They only check
        # if the king or rook has already moved (to check if there are in between checks we do
        # it in gen_moves method).
        self.turn = turn  # True if white's turn, False if black
        self.in_check = in_check # True if the last move gave a check
        self.unsafe_squares = unsafe_squares # When computing moves we are going to store unions of the moveable squares of all pieces so that when the other player has to move
        # we dont need to calculate which places the king can move in.
        self.next_unsafe_squares = 0

    def get_checks(self):
        '''
        Count number of checks and if any slider checks return the bit corresponding to the ray of the slider giving check (To block it later).
        Since after making a check we store in the bitposition we have done so. Hence position has in_check attribute = True.
        We are going to check for checks more efficiently from the kings position and assuming it can move as any piece.
        '''
        bitboard = self.bitboard
        king_position = find_least_significant_bit_set(bitboard[5])
        all_own_pieces_bit = bitboard[0] | bitboard[1] | bitboard[2] | bitboard[3] | bitboard[4] | bitboard[5]
        all_opp_pieces_bit = bitboard[6] | bitboard[7] | bitboard[8] | bitboard[9] | bitboard[10] | bitboard[11]
        checks = 0 # Positions of pieces giving checks (one bitboard)
        rays = set() # Rays, if any, of sliders giving checks
        
        # Pawns
        if bitboard[6] != 0: # For pawns we have to be carefull because they move upwards or downwards depending on whose turn it is
            if self.turn: # White's turn
                attacking_squares = precomputed_move_tables[7][king_position]
                if attacking_squares & bitboard[6] != 0:
                    checks |= attacking_squares & bitboard[6]
            else: # Black's turn
                attacking_squares = precomputed_move_tables[6][king_position]
                if attacking_squares & bitboard[6] != 0:
                    checks |= attacking_squares & bitboard[6]

        # Knights
        if bitboard[7] != 0:
            moveable_squares = precomputed_move_tables[1][king_position]
            if moveable_squares & bitboard[7] != 0: # If there is a knight giving check
                checks |= moveable_squares & bitboard[7]
        # Bishops
        if bitboard[8] != 0:
            moveable_squares = long_precomputed_bishop_table[king_position][bishop_unfull_rays[king_position] & (all_own_pieces_bit | all_opp_pieces_bit)]
            if moveable_squares & bitboard[8] != 0: # If there is a bishop giving check
                checks |= moveable_squares & bitboard[8]
                rays.add(moveable_squares)
        # Rooks
        if bitboard[9] != 0:
            moveable_squares = long_precomputed_rook_table[king_position][rook_unfull_rays[king_position] & (all_own_pieces_bit | all_opp_pieces_bit)]
            if moveable_squares & bitboard[9] != 0: # If there is a rook giving check
                checks |= moveable_squares & bitboard[8]
                rays.add(moveable_squares)
        # Queens
        if bitboard[10] != 0:
            straight_moveable_squares = long_precomputed_rook_table[king_position][rook_unfull_rays[king_position] & (all_own_pieces_bit | all_opp_pieces_bit)]
            diag_moveable_squares = long_precomputed_bishop_table[king_position][bishop_unfull_rays[king_position] & (all_own_pieces_bit | all_opp_pieces_bit)] 
            if straight_moveable_squares & bitboard[11] != 0: # If there is a queen giving check horizontally or vertically
                checks |= moveable_squares & bitboard[11]
                rays.add(moveable_squares)
            if diag_moveable_squares & bitboard[11] != 0: # If there is a queen giving check diagonally
                checks |= moveable_squares & bitboard[11]
                rays.add(moveable_squares)
        return king_position, checks, rays

    def in_check_moves(self):
        '''
        We are going to check for checks more efficiently from the kings position and assuming it can move as any piece.
        This will yield the moves to reduce computational time.
        '''
        bitboard = self.bitboard
        all_own_pieces_bit = bitboard[0] | bitboard[1] | bitboard[2] | bitboard[3] | bitboard[4] | bitboard[5]
        king_position, checks, rays = self.get_checks()

        # We go piece by piece yielding capturing and blocking moves
        # Capturing with King
        piece_bit = bitboard[5]
        if piece_bit != 0: # If we have no pieces of the current type
            origin_square = find_least_significant_bit_set(piece_bit) # We get the indices of the squares pieces of this type are in
            capture_check_squares = precomputed_move_tables[5][origin_square] & checks # We get the precomputed moveable squares
            if capture_check_squares != 0: # If we can capture
                for destination in get_set_bit_indices(capture_check_squares):
                    # We don't put this outside the loop because in most positions it might not even run since king most likely cannot capture
                    new_king_bit = 0 
                    new_king_bit |= 1 << destination
                    if self.unsafe_squares & new_king_bit != 0: # If king is moving into unsafe square we don't consider this move
                        continue

                    later_moveable_squares = precomputed_move_tables[5][destination] # Squares that the piece attacks after making one move
                    if later_moveable_squares & bitboard[11] == 0: # If the piece is not attacking the king
                        yield Move(origin_square, destination, 0, 0) # non-checks will have even is_check attribute
                    else: # Not a check
                        yield Move(origin_square, destination, 0, 1) # checks will have odd is_check attribute

        # Capturing with Pawns
        piece_bit = bitboard[0]
        if piece_bit != 0: # If we can't move pawns
            pawn_indices = get_set_bit_indices(piece_bit) # The indices of the squares the pawns are in
            for origin_square in pawn_indices: # For position of piece of this type
                if self.turn:
                    capture_check_squares = precomputed_move_tables[6][origin_square] & checks # We get the precomputed moveable squares
                else:
                    capture_check_squares = precomputed_move_tables[7][origin_square] & checks # We get the precomputed moveable squares
                if capture_check_squares != 0: # If we can capture pieces giving check
                    for destination in get_set_bit_indices(capture_check_squares):
                        if self.turn:
                            later_moveable_attacks = precomputed_move_tables[6][destination] # Squares that the piece attacks after making one move
                        else:
                            later_moveable_attacks = precomputed_move_tables[7][destination] # Squares that the piece attacks after making one move
                        if later_moveable_attacks & bitboard[11] == 0: # If the piece is attacking the king (check)
                            yield Move(origin_square, destination, 0, 0) # non-checks will have even is_check attribute 
                        else: # A check
                            yield Move(origin_square, destination, 0, 1) # checks will have odd is_check attribute

        # Capturing with knights
        piece_bit = bitboard[1]
        if piece_bit != 0: # If we have no pieces of the current type
            bit_indices = get_set_bit_indices(piece_bit) # We get the indices of the squares pieces of this type are in
            for origin_square in bit_indices: # For position of piece of this type
                capture_check_squares = precomputed_move_tables[1][origin_square] & checks # We get the precomputed moveable squares
                if capture_check_squares != 0: # If we can capture
                    for destination in get_set_bit_indices(capture_check_squares):
                        if piece_index == 5: # If we are moving the king we can't capture into check
                            # We don't put this outside the loop because in most positions it might not even run since king most likely cannot capture
                            new_king_bit = 0 
                            new_king_bit |= 1 << destination
                            if self.unsafe_squares & new_king_bit != 0: # If king is moving into unsafe square we don't consider this move
                                continue

                        later_moveable_squares = precomputed_move_tables[piece_index][destination] # Squares that the piece attacks after making one move
                        if later_moveable_squares & bitboard[11] == 0: # If the piece is not attacking the king
                            yield Move(origin_square, destination, 0, 0) # non-checks will have even is_check attribute
                        else: # Not a check
                            yield Move(origin_square, destination, 0, 1) # checks will have odd is_check attribute
        
        all_pieces_bit = all_own_pieces_bit | bitboard[6] | bitboard[7] | bitboard[8] | bitboard[9] | bitboard[10] | bitboard[11]

        # Capturing with Rooks
        piece_bit = bitboard[3]
        if piece_bit != 0:
            bit_indices = get_set_bit_indices(piece_bit)
            for origin_square in bit_indices:
                capture_check_squares = long_precomputed_rook_table[origin_square][rook_unfull_rays[origin_square] & (all_pieces_bit)] & checks
                if capture_check_squares != 0:
                    destination_bits = get_set_bit_indices(capture_check_squares)
                    for destination in destination_bits:
                        later_moveable_attacks = long_precomputed_rook_table[destination][rook_unfull_rays[destination] & (all_pieces_bit)] # Squares that the piece attacks after making one move
                        if later_moveable_attacks & bitboard[11] == 0: # If the piece is attacking the king (check)
                            yield Move(origin_square, destination, 0, 0) # non-checks will have even is_check attribute
                        else: # A check
                            yield Move(origin_square, destination, 0, 1) # checks will have odd is_check attribute

        # Capturing with Bishops
        piece_bit = bitboard[2]
        if piece_bit != 0:
            bit_indices = get_set_bit_indices(piece_bit)
            for origin_square in bit_indices:
                capture_check_squares = long_precomputed_bishop_table[origin_square][bishop_unfull_rays[origin_square] & (all_pieces_bit)] & checks
                if capture_check_squares != 0:
                    destination_bits = get_set_bit_indices(capture_check_squares)
                    for destination in destination_bits:
                        later_moveable_attacks = long_precomputed_bishop_table[destination][bishop_unfull_rays[destination] & (all_pieces_bit)] # Squares that the piece attacks after making one move
                        if later_moveable_attacks & bitboard[11] == 0: # If the piece is attacking the king (check)
                            yield Move(origin_square, destination, 0, 0) # non-checks will have even is_check attribute
                        else: # A check
                            yield Move(origin_square, destination, 0, 1) # checks will have odd is_check attribute
        
        # Capturing with Queens
        piece_bit = bitboard[4]
        if piece_bit != 0:
            bit_indices = get_set_bit_indices(piece_bit)
            for origin_square in bit_indices:
                capture_check_squares = long_precomputed_bishop_table[origin_square][bishop_unfull_rays[origin_square] & (all_pieces_bit)]
                capture_check_squares |= long_precomputed_rook_table[origin_square][rook_unfull_rays[origin_square] & (all_pieces_bit)]
                capture_check_squares &= checks
                if capture_check_squares != 0:
                    destination_bits = get_set_bit_indices(capture_check_squares)
                    for destination in destination_bits:
                        later_moveable_attacks = long_precomputed_bishop_table[destination][bishop_unfull_rays[destination] & (all_pieces_bit)] # Squares that the piece attacks after making one move
                        later_moveable_attacks |= long_precomputed_rook_table[destination][rook_unfull_rays[destination] & (all_pieces_bit)] # Squares that the piece attacks after making one move
                        if later_moveable_attacks & bitboard[11] == 0: # If the piece is attacking the king (check)
                            yield Move(origin_square, destination, 0, 0) # non-checks will have even is_check attribute 
                        else: # A check
                            yield Move(origin_square, destination, 0, 1) # checks will have odd is_check attribute
        
        # Moving king
        piece_bit = bitboard[5]
        if piece_bit != 0: # If we have no pieces of the current type
            origin_square = find_least_significant_bit_set(piece_bit) # We get the indices of the squares pieces of this type are in
            non_capture_check_squares = precomputed_move_tables[5][origin_square] & ~(checks | all_own_pieces_bit) # We get the precomputed moveable squares
            if non_capture_check_squares != 0: # If we can capture
                for destination in get_set_bit_indices(non_capture_check_squares):
                    # We don't put this outside the loop because in most positions it might not even run since king most likely cannot capture
                    new_king_bit = 0 
                    new_king_bit |= 1 << destination
                    if self.unsafe_squares & new_king_bit != 0: # If king is moving into unsafe square we don't consider this move
                        continue

                    later_moveable_squares = precomputed_move_tables[5][destination] # Squares that the piece attacks after making one move
                    if later_moveable_squares & bitboard[11] == 0: # If the piece is not attacking the king
                        yield Move(origin_square, destination, 0, 0) # non-checks will have even is_check attribute
                    else: # Not a check
                        yield Move(origin_square, destination, 0, 1) # checks will have odd is_check attribute

        


    def capture_moves(self):
        '''
        We create a set of moves and order them in terms of the score, returning a tuple of moves. This set of moves will always be computed before
        non_capture_moves so in this one we compute the next_unsafe_squares, also we are not yielding so we can compute all the next unsafe squares here before making the move.
        '''
        bitboard = self.bitboard
        all_own_pieces_bit = bitboard[0] | bitboard[1] | bitboard[2] | bitboard[3] | bitboard[4] | bitboard[5]
        all_opp_pieces_bit = bitboard[6] | bitboard[7] | bitboard[8] | bitboard[9] | bitboard[10] | bitboard[11]
        all_pieces_bit = all_own_pieces_bit | all_opp_pieces_bit
        captures = []

        # Capturing with knight
        piece_bit = bitboard[1]
        if piece_bit != 0: # If we have no pieces of the current type
            bit_indices = get_set_bit_indices(piece_bit) # We get the indices of the squares pieces of this type are in
            for origin_square in bit_indices: # For position of piece of this type
                moveable_squares = precomputed_move_tables[1][origin_square] # We get the precomputed moveable squares
                self.next_unsafe_squares |= moveable_squares
                if moveable_squares & all_opp_pieces_bit != 0: # Current piece can't capture anything
                    for index in range(6,11): # For each of our opponent pieces, except king
                        capture_squares = moveable_squares & bitboard[index] # We get only squares in which opponent pieces are
                        if capture_squares != 0: # If we can capture
                            for destination in get_set_bit_indices(capture_squares):
                                later_moveable_squares = precomputed_move_tables[1][destination] # Squares that the piece attacks after making one move
                                if later_moveable_squares & bitboard[11] == 0: # If the piece is not attacking the king
                                    captures.append(Move(origin_square, destination, 0, 2*index)) # non-checks will have even is_check attribute 
                                else: # A check
                                    captures.append(Move(origin_square, destination, 0, 2*index-1)) # checks will have odd is_check attribute
        # Capturing with king
        piece_bit = bitboard[5]
        if piece_bit != 0: # If we have no pieces of the current type
            origin_square = find_least_significant_bit_set(piece_bit) # We get the indices of the squares pieces of this type are in
            moveable_squares = precomputed_move_tables[5][origin_square] # We get the precomputed moveable squares
            self.next_unsafe_squares |= moveable_squares
            if moveable_squares & all_opp_pieces_bit != 0: # Current piece can't capture anything
                for index in range(6,11): # For each of our opponent pieces, except king
                    capture_squares = moveable_squares & bitboard[index] # We get only squares in which opponent pieces are
                    if capture_squares != 0: # If we can capture
                        for destination in get_set_bit_indices(capture_squares):
                            # We don't put this outside the loop because in most positions it might not even run since king most likely cannot capture
                            new_king_bit = 0 
                            new_king_bit |= 1 << destination
                            if self.unsafe_squares & new_king_bit != 0: # If king is moving into unsafe square we don't consider this move
                                continue
                            later_moveable_squares = precomputed_move_tables[5][destination] # Squares that the piece attacks after making one move
                            if later_moveable_squares & bitboard[11] == 0: # If the piece is not attacking the king
                                captures.append(Move(origin_square, destination, 0, 2*index)) # non-checks will have even is_check attribute 
                            else: # A check
                                captures.append(Move(origin_square, destination, 0, 2*index-1)) # checks will have odd is_check attribute        
        # Capturing with rook
        piece_bit = bitboard[3]
        if piece_bit != 0:
            bit_indices = get_set_bit_indices(piece_bit)
            for origin_square in bit_indices:
                moveable_squares = long_precomputed_rook_table[origin_square][rook_unfull_rays[origin_square] & (all_pieces_bit)]
                self.next_unsafe_squares |= moveable_squares
                if moveable_squares & all_opp_pieces_bit != 0:
                    for index in range(6,11):
                        capture_squares = moveable_squares & bitboard[index]
                        destination_bits = get_set_bit_indices(capture_squares)
                        for destination in destination_bits:
                            later_moveable_attacks = long_precomputed_rook_table[destination][rook_unfull_rays[destination] & (all_pieces_bit)] # Squares that the piece attacks after making one move
                            if later_moveable_attacks & bitboard[11] == 0: # If the piece is attacking the king (check)
                                captures.append(Move(origin_square, destination, 0, 2*index)) # non-checks will have even is_check attribute
                            else: # A check
                                captures.append(Move(origin_square, destination, 0, 2*index-1)) # checks will have odd is_check attribute

        # Capturing with bishop
        piece_bit = bitboard[2]
        if piece_bit != 0:
            bit_indices = get_set_bit_indices(piece_bit)
            for origin_square in bit_indices:
                moveable_squares = long_precomputed_bishop_table[origin_square][bishop_unfull_rays[origin_square] & (all_pieces_bit)]
                self.next_unsafe_squares |= moveable_squares
                if moveable_squares & all_opp_pieces_bit != 0:
                    for index in range(6,11):
                        capture_squares = moveable_squares & bitboard[index]
                        destination_bits = get_set_bit_indices(capture_squares)
                        for destination in destination_bits:
                            later_moveable_attacks = long_precomputed_bishop_table[destination][bishop_unfull_rays[destination] & (all_pieces_bit)] # Squares that the piece attacks after making one move
                            if later_moveable_attacks & bitboard[11] == 0: # If the piece is attacking the king (check)
                                captures.append(Move(origin_square, destination, 0, 2*index)) # non-checks will have even is_check attribute
                            else: # A check
                                captures.append(Move(origin_square, destination, 0, 2*index-1)) # checks will have odd is_check attribute
        
        # Capturing with queen 
        piece_bit = bitboard[4]
        if piece_bit != 0:
            bit_indices = get_set_bit_indices(piece_bit)
            for origin_square in bit_indices:
                moveable_squares = long_precomputed_bishop_table[origin_square][bishop_unfull_rays[origin_square] & (all_pieces_bit)]
                moveable_squares |= long_precomputed_rook_table[origin_square][rook_unfull_rays[origin_square] & (all_pieces_bit)]
                self.next_unsafe_squares |= moveable_squares
                if moveable_squares & all_opp_pieces_bit != 0:
                    for index in range(6,11):
                        capture_squares = moveable_squares & bitboard[index]
                        destination_bits = get_set_bit_indices(capture_squares)
                        for destination in destination_bits:
                            later_moveable_attacks = long_precomputed_bishop_table[destination][bishop_unfull_rays[destination] & (all_pieces_bit)] # Squares that the piece attacks after making one move
                            later_moveable_attacks |= long_precomputed_rook_table[destination][rook_unfull_rays[destination] & (all_pieces_bit)] # Squares that the piece attacks after making one move
                            if later_moveable_attacks & bitboard[11] == 0: # If the piece is attacking the king (check)
                                captures.append(Move(origin_square, destination, 0, 2*index)) # non-checks will have even is_check attribute
                            else: # A check
                                captures.append(Move(origin_square, destination, 0, 2*index-1)) # checks will have odd is_check attribute
        
        # Capturing with pawns
        piece_bit = bitboard[0]
        if piece_bit != 0: # If we can't move pawns
            pawn_indices = get_set_bit_indices(piece_bit) # The indices of the squares the pawns are in
            for origin_square in pawn_indices: # For position of piece of this type
                if self.turn:
                    attacking_squares = precomputed_move_tables[6][origin_square] # We get the precomputed moveable squares
                else:
                    attacking_squares = precomputed_move_tables[7][origin_square] # We get the precomputed moveable squares
                self.next_unsafe_squares |= attacking_squares
                if attacking_squares & all_opp_pieces_bit != 0: # Current piece can't capture anything
                    for index in range(6,11): # For each of our opponent pieces, except king
                        capture_squares = attacking_squares & bitboard[index] # We get only squares in which opponent pieces are
                        if capture_squares != 0: # If we can capture
                            for destination in get_set_bit_indices(capture_squares):
                                if self.turn:
                                    later_moveable_attacks = precomputed_move_tables[6][destination] # Squares that the piece attacks after making one move
                                else:
                                    later_moveable_attacks = precomputed_move_tables[7][destination] # Squares that the piece attacks after making one move

                                if later_moveable_attacks & bitboard[11] == 0: # If the piece is attacking the king (check)
                                    captures.append(Move(origin_square, destination, 0, 2*index)) # non-checks will have even is_check attribute
                                else: # A check
                                    captures.append(Move(origin_square, destination, 0, 2*index-1)) # checks will have odd is_check attribute

        return [move for move in sorted(captures, key=lambda move: move.is_check, reverse=True)] # return the moves ordered in terms of the score and make is_check = 0 for all

    def non_capture_moves(self):
        '''
        This will be a generator which when checking if move is a check it yields a move with score 1, else 0.
        '''
        bitboard = self.bitboard
        all_own_pieces_bit = bitboard[0] | bitboard[1] | bitboard[2] | bitboard[3] | bitboard[4] | bitboard[5]
        all_opp_pieces_bit = bitboard[6] | bitboard[7] | bitboard[8] | bitboard[9] | bitboard[10] | bitboard[11]
        all_pieces_bit = all_own_pieces_bit | all_opp_pieces_bit

        # Knights
        piece_bit = bitboard[1]
        if piece_bit != 0:
            for origin_square in get_set_bit_indices(piece_bit): # For position of piece of this type
                moveable_squares = precomputed_move_tables[1][origin_square] & ~all_pieces_bit # We get the precomputed moveable squares, note captures are computed on capture_moves().
                if moveable_squares != 0: # If we can move our piece
                    for destination in get_set_bit_indices(moveable_squares): # get_set_bit_indices is a generator so yielding bellow makes it more efficient
                        later_moveable_squares = precomputed_move_tables[1][destination] # Squares that the piece attacks after making one move
                        if later_moveable_squares & bitboard[11] != 0: # If the piece is attacking the king we yield, so that the move is computed first
                            yield Move(origin_square, destination, 0, 1)
                        else: # Not a check
                            yield Move(origin_square, destination, 0, 0)

        # King 
        piece_bit = bitboard[5]
        if piece_bit != 0:
            origin_square = find_least_significant_bit_set(piece_bit) # For position of piece of this type
            moveable_squares = precomputed_move_tables[5][origin_square] & ~all_pieces_bit # We get the precomputed moveable squares, note captures are computed on capture_moves().
            if moveable_squares != 0: # If we can move our piece
                for destination in get_set_bit_indices(moveable_squares): # get_set_bit_indices is a generator so yielding bellow makes it more efficient
                    new_king_bit = 0 
                    new_king_bit |= 1 << destination
                    if self.unsafe_squares & new_king_bit != 0: # If king is moving into unsafe square we don't consider this move
                        continue
                    later_moveable_squares = precomputed_move_tables[5][destination] # Squares that the piece attacks after making one move
                    if later_moveable_squares & bitboard[11] != 0: # If the piece is attacking the king we yield, so that the move is computed first
                        yield Move(origin_square, destination, 0, 1)
                    else: # Not a check
                        yield Move(origin_square, destination, 0, 0)
                            
        # Pawns
        piece_bit = bitboard[0] 
        if piece_bit != 0:
            for origin_square in get_set_bit_indices(piece_bit): # For position of piece of this type
                if self.turn:
                    moveable_squares = precomputed_move_tables[0][origin_square] & ~all_pieces_bit # We get rid of the squares in which our own or opp pieces are
                else:
                    moveable_squares = precomputed_move_tables[8][origin_square] & ~all_pieces_bit # We get rid of the squares in which our own or opp pieces are
                if moveable_squares != 0:
                    for destination in get_set_bit_indices(moveable_squares):
                        if self.turn:
                            later_moveable_attacks = precomputed_move_tables[6][destination] # Squares that the piece attacks after making one move
                        else:
                            later_moveable_attacks = precomputed_move_tables[7][destination] # Squares that the piece attacks after making one move

                        if later_moveable_attacks & bitboard[11] != 0: # If the pawn is attacking the king we yield, so that the move is computed first
                            yield Move(origin_square, destination, 0, 1)
                        else: # The pawn is not giving check
                            yield Move(origin_square, destination, 0, 0)

        # Bishops
        piece_bit = bitboard[2]
        if piece_bit != 0:
            for origin_square in get_set_bit_indices(piece_bit): # For position of piece of this type
                moveable_squares = long_precomputed_bishop_table[origin_square][bishop_unfull_rays[origin_square] & (all_pieces_bit)]
                moveable_squares &= ~ all_pieces_bit
                if moveable_squares != 0:
                    for destination in get_set_bit_indices(moveable_squares):
                        later_moveable_attacks = long_precomputed_bishop_table[destination][bishop_unfull_rays[destination] & (all_pieces_bit)] # Squares that the piece attacks after making one move
                        if later_moveable_attacks & bitboard[11] != 0: # If the piece is attacking the king we yield, so that the move is computed first
                            yield Move(origin_square, destination, 0, 1)
                        else: # The bishop is giving check
                            yield Move(origin_square, destination, 0, 0)
        # Rooks
        piece_bit = bitboard[3]
        if piece_bit != 0:
            for origin_square in get_set_bit_indices(piece_bit): # For position of piece of this type
                moveable_squares = long_precomputed_rook_table[origin_square][rook_unfull_rays[origin_square] & (all_pieces_bit)]
                moveable_squares &= ~ all_pieces_bit
                if moveable_squares != 0:
                    for destination in get_set_bit_indices(moveable_squares):
                        later_moveable_attacks = long_precomputed_rook_table[destination][rook_unfull_rays[destination] & (all_pieces_bit)] # Squares that the piece attacks after making one move
                        if later_moveable_attacks & bitboard[11] != 0: # If the piece is attacking the king we yield, so that the move is computed first
                            yield Move(origin_square, destination, 0, 1)
                        else: # The rook is giving check
                            yield Move(origin_square, destination, 0, 0)
        
        # Queens
        piece_bit = bitboard[4]
        if piece_bit != 0:
            for origin_square in get_set_bit_indices(piece_bit): # For position of piece of this type
                diag_moveable_squares = long_precomputed_bishop_table[origin_square][bishop_unfull_rays[origin_square] & (all_pieces_bit)]
                diag_moveable_squares &= ~ all_pieces_bit
                straight_moveable_squares = long_precomputed_rook_table[origin_square][rook_unfull_rays[origin_square] & (all_pieces_bit)]
                straight_moveable_squares &= ~ all_pieces_bit
                if straight_moveable_squares != 0:
                    for destination in get_set_bit_indices(straight_moveable_squares):
                        later_moveable_attacks = long_precomputed_rook_table[destination][rook_unfull_rays[destination] & (all_pieces_bit)] # Squares that the piece attacks after making one move
                        if later_moveable_attacks & bitboard[11] != 0: # If the piece is attacking the king we yield, so that the move is computed first
                            yield Move(origin_square, destination, 0, 1)
                        else: # The pawn is not giving check
                            yield Move(origin_square, destination, 0, 0)

                if diag_moveable_squares != 0:
                    for destination in get_set_bit_indices(diag_moveable_squares):
                        later_moveable_attacks = long_precomputed_bishop_table[destination][bishop_unfull_rays[destination] & (all_pieces_bit)] # Squares that the piece attacks after making one move
                        if later_moveable_attacks & bitboard[11] != 0: # If the piece is attacking the king we yield, so that the move is computed first
                            yield Move(origin_square, destination, 0, 1)
                        else: # The pawn is not giving check
                            yield Move(origin_square, destination, 0, 0)
    

    def move(self, move):
        '''
        Move piece and switch white and black roles.
        '''
        bitboard = self.bitboard

        capture_indx = None
        checking = move.is_check % 2
        if move.is_check not in (0,1):
            if checking:
                capture_indx = (move.is_check+1)/2
            else:
                capture_indx = (move.is_check)/2

        # Switch roles
        new_bitboard = []
        for indx in range(6, 12): # Put opponents pieces at the start and take off if captured
            if indx == capture_indx: # If this is the piece we are capturing
                bitboard[indx] &= ~(1 << move.j)
            new_bitboard.append(bitboard[indx])

        for indx in range(6): # Then put our pieces and change the moving one
            if move.i in get_set_bit_indices(bitboard[indx]): # If this is the piece we are moving
                moving_piece = indx
                bitboard[indx] &= ~(1 << move.i)
                bitboard[indx] |= 1 << move.j
            new_bitboard.append(bitboard[indx])


        # Update psquare if needed
        new_psquare = -1
        if self.turn and moving_piece == 0 and move.j - move.i == 16: # If we are moving a pawn twice
            new_psquare = move.i + 8
        elif not self.turn and moving_piece == 0 and move.j - move.i == -16: # If we are moving a pawn twice
            new_psquare = move.j + 8

        return BitPosition(new_bitboard, new_psquare, self.bc, self.wc, not self.turn, checking, self.next_unsafe_squares)

    def pop(self):
        return 0
    
    def capture_moves_using_yield(self):
        #WE CAN TRY USING YIELD LATER, BUT I THINK IT WOULD REQUIRE TOO MANY EXTRA MEMORY, SLOWING THINGS DOWN.
        #BECAUSE IF WE YIELD, WE MUST COMPUTE CAPTURES IN ORDER. AND WE HAVE TO TRY NOT TO STORE TOO MANY VARIABLES?
        
        #We yield captures in this order:
        #(Pq, Pr, Nq, Bq, Pb, Pn, Nr, Br, Kq, Kr, Kb, Kn, Kp,  Qq, Rr, Bb, Nn, Pp,  Rb, Rn, Np, Bp, Qb, Qn, Rp, Qp). 
        #However we also use rest_moves_list.

        bitboard = self.bitboard
        # Pawn queen captures and rook captures
        pawns_bit = bitboard[0]
        if pawns_bit != 0:
            pawns_bit_indices = get_set_bit_indices(pawns_bit) # We get the indices of the squares our pawns are in
            for current_square in pawns_bit_indices:
                attack_squares = precomputed_move_tables[6]
                opponent_queens = bitboard[10]
                for destination in  get_set_bit_indices(attack_squares & opponent_queens):
                    yield Move(current_square, destination, 0, 0)
            for current_square in pawns_bit_indices:
                attack_squares = precomputed_move_tables[6]
                opponent_rooks = bitboard[9]
                for destination in  get_set_bit_indices(attack_squares & opponent_rooks):
                    yield Move(current_square, destination, 0, 0)
        
        # Knight queen captures
        